import{c as t,a as e,u as r}from"./p-7005d10f.js";function s(t,e,r){return t instanceof Object==0?r:e in t?t[e]:r}function i(t,e=0,r=t.byteLength-e,s=!1){let i="";for(const n of new Uint8Array(t,e,r)){const t=n.toString(16).toUpperCase();1===t.length&&(i+="0"),i+=t,s&&(i+=" ")}return i.trim()}function n(t,e,r,s){return e instanceof ArrayBuffer==0?(t.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===e.byteLength?(t.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(t.error="Wrong parameter: inputOffset less than zero",!1):s<0?(t.error="Wrong parameter: inputLength less than zero",!1):!(e.byteLength-r-s<0&&(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1))}function o(t,e){let r=0;if(1===t.length)return t[0];for(let s=t.length-1;s>=0;s--)r+=t[t.length-1-s]*Math.pow(2,e*s);return r}function a(t,e,r=-1){const s=r;let i=t,n=0,o=Math.pow(2,e);for(let a=1;a<8;a++){if(t<o){let t;if(s<0)t=new ArrayBuffer(a),n=a;else{if(s<a)return new ArrayBuffer(0);t=new ArrayBuffer(s),n=s}const r=new Uint8Array(t);for(let s=a-1;s>=0;s--){const t=Math.pow(2,s*e);r[n-s-1]=Math.floor(i/t),i-=r[n-s-1]*t}return t}o*=Math.pow(2,e)}return new ArrayBuffer(0)}function c(...t){let e=0,r=0;for(const n of t)e+=n.byteLength;const s=new ArrayBuffer(e),i=new Uint8Array(s);for(const n of t)i.set(new Uint8Array(n),r),r+=n.byteLength;return s}function u(...t){let e=0,r=0;for(const n of t)e+=n.length;const s=new ArrayBuffer(e),i=new Uint8Array(s);for(const n of t)i.set(n,r),r+=n.length;return i}function h(){const t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const e=0===t[0]&&0==(128&t[1]);(255===t[0]&&128&t[1]||e)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(e);for(let o=0;o<this.valueHex.byteLength;o++)r[o]=0;r[0]=128&t[0];const s=o(r,8),i=new ArrayBuffer(this.valueHex.byteLength),n=new Uint8Array(i);for(let o=0;o<this.valueHex.byteLength;o++)n[o]=t[o];return n[0]&=127,o(n,8)-s}function f(t,e){if(t.byteLength!==e.byteLength)return!1;const r=new Uint8Array(t),s=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]!==s[i])return!1;return!0}function l(t,e){const r=t.toString(10);if(e<r.length)return"";const s=e-r.length,i=new Array(s);for(let n=0;n<s;n++)i[n]="0";return i.join("").concat(r)}const d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=";function y(t,e=!1,r=!1,s=!1){let i=0,n=0,o=0,a="";const c=e?p:d;if(s){let e=0;for(let r=0;r<t.length;r++)if(0!==t.charCodeAt(r)){e=r;break}t=t.slice(e)}for(;i<t.length;){const e=t.charCodeAt(i++);i>=t.length&&(n=1);const s=t.charCodeAt(i++);i>=t.length&&(o=1);const u=t.charCodeAt(i++),h=e>>2,f=(3&e)<<4|s>>4;let l=(15&s)<<2|u>>6,d=63&u;1===n?l=d=64:1===o&&(d=64),a+=r?64===l?`${c.charAt(h)}${c.charAt(f)}`:64===d?`${c.charAt(h)}${c.charAt(f)}${c.charAt(l)}`:`${c.charAt(h)}${c.charAt(f)}${c.charAt(l)}${c.charAt(d)}`:`${c.charAt(h)}${c.charAt(f)}${c.charAt(l)}${c.charAt(d)}`}return a}function w(t,e=!1,r=!1){const s=e?p:d;function i(t){for(let e=0;e<64;e++)if(s.charAt(e)===t)return e;return 64}function n(t){return 64===t?0:t}let o=0,a="";for(;o<t.length;){const e=i(t.charAt(o++)),r=o>=t.length?0:i(t.charAt(o++)),s=o>=t.length?0:i(t.charAt(o++)),c=o>=t.length?0:i(t.charAt(o++)),u=n(e)<<2|n(r)>>4,h=(15&n(r))<<4|n(s)>>2,f=(3&n(s))<<6|n(c);a+=String.fromCharCode(u),64!==s&&(a+=String.fromCharCode(h)),64!==c&&(a+=String.fromCharCode(f))}if(r){let t=-1;for(let e=a.length-1;e>=0;e--)if(0!==a.charCodeAt(e)){t=e;break}a=-1!==t?a.slice(0,t+1):""}return a}function m(t){let e="";const r=new Uint8Array(t);for(const s of r)e+=String.fromCharCode(s);return e}function v(t){const e=t.length,r=new ArrayBuffer(e),s=new Uint8Array(r);for(let i=0;i<e;i++)s[i]=t.charCodeAt(i);return r}const g=Math.log(2);function A(t){const e=Math.log(t)/g,r=Math.floor(e),s=Math.round(e);return r===s?r:s}function b(t,e){for(const r of e)delete t[r]}const S=[new Uint8Array([1])];class B{constructor(t={}){this.blockLength=s(t,"blockLength",0),this.error=s(t,"error",""),this.warnings=s(t,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in t?t.valueBeforeDecode.slice(0):new ArrayBuffer(0)}static blockName(){return"baseBlock"}toJSON(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:i(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}const N=t=>class extends t{constructor(t={}){super(t),this.isHexOnly=s(t,"isHexOnly",!1),this.valueHex="valueHex"in t?t.valueHex.slice(0):new ArrayBuffer(0)}static blockName(){return"hexBlock"}fromBER(t,e,r){return!1===n(this,t,e,r)?-1:0===new Uint8Array(t,e,r).length?(this.warnings.push("Zero buffer length"),e):(this.valueHex=t.slice(e,e+r),this.blockLength=r,e+r)}toBER(t=!1){return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===t?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.blockName=this.constructor.blockName(),t.isHexOnly=this.isHexOnly,t.valueHex=i(this.valueHex,0,this.valueHex.byteLength),t}};class k extends(N(B)){constructor(t={}){super(),"idBlock"in t?(this.isHexOnly=s(t.idBlock,"isHexOnly",!1),this.valueHex=s(t.idBlock,"valueHex",new ArrayBuffer(0)),this.tagClass=s(t.idBlock,"tagClass",-1),this.tagNumber=s(t.idBlock,"tagNumber",-1),this.isConstructed=s(t.idBlock,"isConstructed",!1)):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}static blockName(){return"identificationBlock"}toBER(t=!1){let e,r,s=0;switch(this.tagClass){case 1:s|=0;break;case 2:s|=64;break;case 3:s|=128;break;case 4:s|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(s|=32),this.tagNumber<31&&!this.isHexOnly){if(e=new ArrayBuffer(1),r=new Uint8Array(e),!t){let t=this.tagNumber;t&=31,s|=t,r[0]=s}return e}if(!1===this.isHexOnly){const i=a(this.tagNumber,7),n=new Uint8Array(i),o=i.byteLength;if(e=new ArrayBuffer(o+1),r=new Uint8Array(e),r[0]=31|s,!t){for(let t=0;t<o-1;t++)r[t+1]=128|n[t];r[o]=n[o-1]}return e}if(e=new ArrayBuffer(this.valueHex.byteLength+1),r=new Uint8Array(e),r[0]=31|s,!1===t){const t=new Uint8Array(this.valueHex);for(let e=0;e<t.length-1;e++)r[e+1]=128|t[e];r[this.valueHex.byteLength]=t[t.length-1]}return e}fromBER(t,e,r){if(!1===n(this,t,e,r))return-1;const s=new Uint8Array(t,e,r);if(0===s.length)return this.error="Zero buffer length",-1;switch(192&s[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&s[0]),this.isHexOnly=!1;const i=31&s[0];if(31!==i)this.tagNumber=i,this.blockLength=1;else{let t=1;this.valueHex=new ArrayBuffer(255);let e=255,r=new Uint8Array(this.valueHex);for(;128&s[t];){if(r[t-1]=127&s[t],t++,t>=s.length)return this.error="End of input reached before message was fully decoded",-1;if(t===e){e+=255;const t=new ArrayBuffer(e),s=new Uint8Array(t);for(let e=0;e<r.length;e++)s[e]=r[e];this.valueHex=new ArrayBuffer(e),r=new Uint8Array(this.valueHex)}}this.blockLength=t+1,r[t-1]=127&s[t];const i=new ArrayBuffer(t),n=new Uint8Array(i);for(let s=0;s<t;s++)n[s]=r[s];this.valueHex=new ArrayBuffer(t),r=new Uint8Array(this.valueHex),r.set(n),this.blockLength<=9?this.tagNumber=o(r,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return e+this.blockLength}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.blockName=this.constructor.blockName(),t.tagClass=this.tagClass,t.tagNumber=this.tagNumber,t.isConstructed=this.isConstructed,t}}class x extends B{constructor(t={}){super(),"lenBlock"in t?(this.isIndefiniteForm=s(t.lenBlock,"isIndefiniteForm",!1),this.longFormUsed=s(t.lenBlock,"longFormUsed",!1),this.length=s(t.lenBlock,"length",0)):(this.isIndefiniteForm=!1,this.longFormUsed=!1,this.length=0)}static blockName(){return"lengthBlock"}fromBER(t,e,r){if(!1===n(this,t,e,r))return-1;const s=new Uint8Array(t,e,r);if(0===s.length)return this.error="Zero buffer length",-1;if(255===s[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===s[0],!0===this.isIndefiniteForm)return this.blockLength=1,e+this.blockLength;if(this.longFormUsed=!!(128&s[0]),!1===this.longFormUsed)return this.length=s[0],this.blockLength=1,e+this.blockLength;const i=127&s[0];if(i>8)return this.error="Too big integer",-1;if(i+1>s.length)return this.error="End of input reached before message was fully decoded",-1;const a=new Uint8Array(i);for(let n=0;n<i;n++)a[n]=s[n+1];return 0===a[i-1]&&this.warnings.push("Needlessly long encoded length"),this.length=o(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=i+1,e+this.blockLength}toBER(t=!1){let e,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return e=new ArrayBuffer(1),!1===t&&(r=new Uint8Array(e),r[0]=128),e;if(!0===this.longFormUsed){const s=a(this.length,8);if(s.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(e=new ArrayBuffer(s.byteLength+1),!0===t)return e;const i=new Uint8Array(s);r=new Uint8Array(e),r[0]=128|s.byteLength;for(let t=0;t<s.byteLength;t++)r[t+1]=i[t];return e}return e=new ArrayBuffer(1),!1===t&&(r=new Uint8Array(e),r[0]=this.length),e}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.blockName=this.constructor.blockName(),t.isIndefiniteForm=this.isIndefiniteForm,t.longFormUsed=this.longFormUsed,t.length=this.length,t}}class E extends B{constructor(t={}){super(t)}static blockName(){return"valueBlock"}fromBER(t,e,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}toBER(t=!1){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')}}class U extends B{constructor(t={},e=E){super(t),"name"in t&&(this.name=t.name),"optional"in t&&(this.optional=t.optional),"primitiveSchema"in t&&(this.primitiveSchema=t.primitiveSchema),this.idBlock=new k(t),this.lenBlock=new x(t),this.valueBlock=new e(t)}static blockName(){return"BaseBlock"}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}toBER(t=!1){let e;const r=this.idBlock.toBER(t),s=this.valueBlock.toBER(!0);let i;if(this.lenBlock.length=s.byteLength,e=c(r,this.lenBlock.toBER(t)),i=!1===t?this.valueBlock.toBER(t):new ArrayBuffer(this.lenBlock.length),e=c(e,i),!0===this.lenBlock.isIndefiniteForm){const r=new ArrayBuffer(2);if(!1===t){const t=new Uint8Array(r);t[0]=0,t[1]=0}e=c(e,r)}return e}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.idBlock=this.idBlock.toJSON(),t.lenBlock=this.lenBlock.toJSON(),t.valueBlock=this.valueBlock.toJSON(),"name"in this&&(t.name=this.name),"optional"in this&&(t.optional=this.optional),"primitiveSchema"in this&&(t.primitiveSchema=this.primitiveSchema.toJSON()),t}toString(){return`${this.constructor.blockName()} : ${i(this.valueBlock.valueHex)}`}}class O extends E{constructor(t={}){super(t),this.valueHex="valueHex"in t?t.valueHex.slice(0):new ArrayBuffer(0),this.isHexOnly=s(t,"isHexOnly",!0)}fromBER(t,e,r){if(!1===n(this,t,e,r))return-1;const s=new Uint8Array(t,e,r);if(0===s.length)return this.warnings.push("Zero buffer length"),e;this.valueHex=new ArrayBuffer(s.length);const i=new Uint8Array(this.valueHex);for(let n=0;n<s.length;n++)i[n]=s[n];return this.blockLength=r,e+r}toBER(t=!1){return this.valueHex.slice(0)}static blockName(){return"PrimitiveValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.valueHex=i(this.valueHex,0,this.valueHex.byteLength),t.isHexOnly=this.isHexOnly,t}}class I extends U{constructor(t={}){super(t,O),this.idBlock.isConstructed=!1}static blockName(){return"PRIMITIVE"}}class R extends E{constructor(t={}){super(t),this.value=s(t,"value",[]),this.isIndefiniteForm=s(t,"isIndefiniteForm",!1)}fromBER(t,e,r){const s=e,i=r;if(!1===n(this,t,e,r))return-1;if(0===new Uint8Array(t,e,r).length)return this.warnings.push("Zero buffer length"),e;let o=e;for(;(!0===this.isIndefiniteForm?1:r)>0;){const e=Et(t,o,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(o=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),!0===this.isIndefiniteForm&&e.result.constructor.blockName()===j.blockName())break}return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===j.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=t.slice(s,s+i),o}toBER(t=!1){let e=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++)e=c(e,this.value[r].toBER(t));return e}static blockName(){return"ConstructedValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}t.isIndefiniteForm=this.isIndefiniteForm,t.value=[];for(let r=0;r<this.value.length;r++)t.value.push(this.value[r].toJSON());return t}}class T extends U{constructor(t={}){super(t,R),this.idBlock.isConstructed=!0}static blockName(){return"CONSTRUCTED"}fromBER(t,e,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}toString(){const t=[];for(const r of this.valueBlock.value)t.push(r.toString().split("\n").map(t=>"  "+t).join("\n"));const e=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.blockName();return t.length?`${e} :\n${t.join("\n")}`:e+" :"}}class $ extends E{constructor(t={}){super(t)}fromBER(t,e,r){return e}toBER(t=!1){return new ArrayBuffer(0)}static blockName(){return"EndOfContentValueBlock"}}class j extends U{constructor(t={}){super(t,$),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}static blockName(){return"EndOfContent"}}class C extends E{constructor(t={}){super(t),this.value=s(t,"value",!1),this.isHexOnly=s(t,"isHexOnly",!1),"valueHex"in t?this.valueHex=t.valueHex.slice(0):(this.valueHex=new ArrayBuffer(1),!0===this.value&&(new Uint8Array(this.valueHex)[0]=255))}fromBER(t,e,r){if(!1===n(this,t,e,r))return-1;const s=new Uint8Array(t,e,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,this.valueHex=new ArrayBuffer(s.length);const i=new Uint8Array(this.valueHex);for(let n=0;n<s.length;n++)i[n]=s[n];return this.value=0!==h.call(this),this.blockLength=r,e+r}toBER(t=!1){return this.valueHex}static blockName(){return"BooleanValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.value=this.value,t.isHexOnly=this.isHexOnly,t.valueHex=i(this.valueHex,0,this.valueHex.byteLength),t}}class D extends U{constructor(t={}){super(t,C),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}static blockName(){return"BOOLEAN"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class V extends T{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}static blockName(){return"SEQUENCE"}}class P extends T{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}static blockName(){return"SET"}}class W extends U{constructor(t={}){super(t,B),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}static blockName(){return"NULL"}fromBER(t,e,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,e+r>t.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):e+r}toBER(t=!1){const e=new ArrayBuffer(2);if(!0===t)return e;const r=new Uint8Array(e);return r[0]=5,r[1]=0,e}toString(){return""+this.constructor.blockName()}}class M extends(N(R)){constructor(t={}){super(t),this.isConstructed=s(t,"isConstructed",!1)}fromBER(t,e,r){let s=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,s=R.prototype.fromBER.call(this,t,e,r),-1===s)return s;for(let t=0;t<this.value.length;t++){const e=this.value[t].constructor.blockName();if(e===j.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(e!==H.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,s=super.fromBER(t,e,r),this.blockLength=r;return s}toBER(t=!1){if(!0===this.isConstructed)return R.prototype.toBER.call(this,t);let e=new ArrayBuffer(this.valueHex.byteLength);return!0===t||0===this.valueHex.byteLength||(e=this.valueHex.slice(0)),e}static blockName(){return"OctetStringValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.isConstructed=this.isConstructed,t.isHexOnly=this.isHexOnly,t.valueHex=i(this.valueHex,0,this.valueHex.byteLength),t}}class H extends U{constructor(t={}){super(t,M),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(t,e,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),e;if(!this.valueBlock.isConstructed){const i=t.slice(e,e+r);try{const t=Ut(i);-1!==t.offset&&t.offset===r&&(this.valueBlock.value=[t.result])}catch(s){}}return super.fromBER(t,e,r)}static blockName(){return"OCTET STRING"}isEqual(t){return t instanceof H!=0&&JSON.stringify(this)===JSON.stringify(t)}toString(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?T.prototype.toString.call(this):`${this.constructor.blockName()} : ${i(this.valueBlock.valueHex)}`}}class J extends(N(R)){constructor(t={}){super(t),this.unusedBits=s(t,"unusedBits",0),this.isConstructed=s(t,"isConstructed",!1),this.blockLength=this.valueHex.byteLength}fromBER(t,e,r){if(0===r)return e;let s=-1;if(!0===this.isConstructed){if(s=R.prototype.fromBER.call(this,t,e,r),-1===s)return s;for(let t=0;t<this.value.length;t++){const e=this.value[t].constructor.blockName();if(e===j.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(e!==z.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[t].valueBlock.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[t].valueBlock.unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return s}if(!1===n(this,t,e,r))return-1;const i=new Uint8Array(t,e,r);if(this.unusedBits=i[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const s=t.slice(e+1,e+r);try{const t=Ut(s);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}catch(a){}}this.valueHex=new ArrayBuffer(i.length-1);const o=new Uint8Array(this.valueHex);for(let n=0;n<r-1;n++)o[n]=i[n+1];return this.blockLength=i.length,e+r}toBER(t=!1){if(!0===this.isConstructed)return R.prototype.toBER.call(this,t);if(!0===t)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);const e=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),s=new Uint8Array(r);s[0]=this.unusedBits;for(let i=0;i<this.valueHex.byteLength;i++)s[i+1]=e[i];return r}static blockName(){return"BitStringValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.unusedBits=this.unusedBits,t.isConstructed=this.isConstructed,t.isHexOnly=this.isHexOnly,t.valueHex=i(this.valueHex,0,this.valueHex.byteLength),t}}class z extends U{constructor(t={}){super(t,J),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}static blockName(){return"BIT STRING"}fromBER(t,e,r){return 0===r?e:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(t,e,r))}isEqual(t){return t instanceof z!=0&&JSON.stringify(this)===JSON.stringify(t)}toString(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return T.prototype.toString.call(this);{const t=[],e=new Uint8Array(this.valueBlock.valueHex);for(const r of e)t.push(r.toString(2).padStart(8,"0"));return`${this.constructor.blockName()} : ${t.join("")}`}}}class G extends(N(E)){constructor(t={}){super(t),"value"in t&&(this.valueDec=t.value)}set valueHex(t){this._valueHex=t.slice(0),t.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,t.byteLength>0&&(this._valueDec=h.call(this)))}get valueHex(){return this._valueHex}set valueDec(t){this._valueDec=t,this.isHexOnly=!1,this._valueHex=function(t){const e=t<0?-1*t:t;let r=128;for(let s=1;s<8;s++){if(e<=r){if(t<0){const t=a(r-e,8,s);return new Uint8Array(t)[0]|=128,t}let i=a(e,8,s),n=new Uint8Array(i);if(128&n[0]){const t=i.slice(0),e=new Uint8Array(t);i=new ArrayBuffer(i.byteLength+1),n=new Uint8Array(i);for(let r=0;r<t.byteLength;r++)n[r+1]=e[r];n[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(t)}get valueDec(){return this._valueDec}fromDER(t,e,r,s=0){const i=this.fromBER(t,e,r);if(-1===i)return i;const n=new Uint8Array(this._valueHex);if(0===n[0]&&0!=(128&n[1])){const t=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(t).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=t.slice(0)}else if(0!==s&&this._valueHex.byteLength<s){s-this._valueHex.byteLength>1&&(s=this._valueHex.byteLength+1);const t=new ArrayBuffer(s);new Uint8Array(t).set(n,s-this._valueHex.byteLength),this._valueHex=t.slice(0)}return i}toDER(t=!1){const e=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&e[0]):{const t=new ArrayBuffer(this._valueHex.byteLength+1),r=new Uint8Array(t);r[0]=0,r.set(e,1),this._valueHex=t.slice(0)}break;case 0===e[0]&&0==(128&e[1]):{const t=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(t).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=t.slice(0)}}return this.toBER(t)}fromBER(t,e,r){const s=super.fromBER(t,e,r);return-1===s?s:(this.blockLength=r,e+r)}toBER(t=!1){return this.valueHex.slice(0)}static blockName(){return"IntegerValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.valueDec=this.valueDec,t}toString(){function t(t,e){const r=new Uint8Array([0]);let s=new Uint8Array(t),i=new Uint8Array(e),n=s.slice(0);const o=n.length-1;let a=i.slice(0);const c=a.length-1;let h=0,f=0;for(let l=c<o?o:c;l>=0;l--,f++){switch(!0){case f<a.length:h=n[o-f]+a[c-f]+r[0];break;default:h=n[o-f]+r[0]}switch(r[0]=h/10,!0){case f>=n.length:n=u(new Uint8Array([h%10]),n);break;default:n[o-f]=h%10}}return r[0]>0&&(n=u(r,n)),n.slice(0)}function e(t){if(t>=S.length)for(let e=S.length;e<=t;e++){const t=new Uint8Array([0]);let r=S[e-1].slice(0);for(let e=r.length-1;e>=0;e--){const s=new Uint8Array([(r[e]<<1)+t[0]]);t[0]=s[0]/10,r[e]=s[0]%10}t[0]>0&&(r=u(t,r)),S.push(r)}return S[t]}function r(t,e){let r=0,s=new Uint8Array(t),i=new Uint8Array(e),n=s.slice(0);const o=n.length-1;let a=i.slice(0);const c=a.length-1;let u,h=0;for(let f=c;f>=0;f--,h++)switch(u=n[o-h]-a[c-h]-r,!0){case u<0:r=1,n[o-h]=u+10;break;default:r=0,n[o-h]=u}if(r>0)for(let f=o-c+1;f>=0;f--,h++){if(u=n[o-h]-r,!(u<0)){r=0,n[o-h]=u;break}r=1,n[o-h]=u+10}return n.slice()}const s=8*this._valueHex.byteLength-1;let i,n=new Uint8Array(8*this._valueHex.byteLength/3),o=0;const a=new Uint8Array(this._valueHex);let c="",h=!1;for(let u=this._valueHex.byteLength-1;u>=0;u--){i=a[u];for(let a=0;a<8;a++){if(1==(1&i))switch(o){case s:n=r(e(o),n),c="-";break;default:n=t(n,e(o))}o++,i>>=1}}for(let u=0;u<n.length;u++)n[u]&&(h=!0),h&&(c+="0123456789".charAt(n[u]));return!1===h&&(c+="0123456789".charAt(0)),c}}class L extends U{constructor(t={}){super(t,G),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}static blockName(){return"INTEGER"}isEqual(t){return t instanceof L?this.valueBlock.isHexOnly&&t.valueBlock.isHexOnly?f(this.valueBlock.valueHex,t.valueBlock.valueHex):this.valueBlock.isHexOnly===t.valueBlock.isHexOnly&&this.valueBlock.valueDec===t.valueBlock.valueDec:t instanceof ArrayBuffer&&f(this.valueBlock.valueHex,t)}convertToDER(){const t=new L({valueHex:this.valueBlock.valueHex});return t.valueBlock.toDER(),t}convertFromDER(){const t=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,e=new L({valueHex:this.valueBlock.valueHex});return e.valueBlock.fromDER(e.valueBlock.valueHex,0,e.valueBlock.valueHex.byteLength,t),e}toString(){const t=i(this.valueBlock.valueHex),e=BigInt("0x"+t);return`${this.constructor.blockName()} : ${e.toString()}`}}class q extends L{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}static blockName(){return"ENUMERATED"}}class F extends(N(B)){constructor(t={}){super(t),this.valueDec=s(t,"valueDec",-1),this.isFirstSid=s(t,"isFirstSid",!1)}static blockName(){return"sidBlock"}fromBER(t,e,r){if(0===r)return e;if(!1===n(this,t,e,r))return-1;const s=new Uint8Array(t,e,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let n=0;n<r&&(i[n]=127&s[n],this.blockLength++,0!=(128&s[n]));n++);const a=new ArrayBuffer(this.blockLength),c=new Uint8Array(a);for(let n=0;n<this.blockLength;n++)c[n]=i[n];return this.valueHex=a.slice(0),i=new Uint8Array(this.valueHex),0!=(128&s[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=o(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t=!1){let e,r;if(this.isHexOnly){if(!0===t)return new ArrayBuffer(this.valueHex.byteLength);const s=new Uint8Array(this.valueHex);e=new ArrayBuffer(this.blockLength),r=new Uint8Array(e);for(let t=0;t<this.blockLength-1;t++)r[t]=128|s[t];return r[this.blockLength-1]=s[this.blockLength-1],e}const s=a(this.valueDec,7);if(0===s.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(e=new ArrayBuffer(s.byteLength),!1===t){const t=new Uint8Array(s);r=new Uint8Array(e);for(let e=0;e<s.byteLength-1;e++)r[e]=128|t[e];r[s.byteLength-1]=t[s.byteLength-1]}return e}toString(){let t="";if(!0===this.isHexOnly)t=i(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){let e=this.valueDec;this.valueDec<=39?t="0.":this.valueDec<=79?(t="1.",e-=40):(t="2.",e-=80),t+=e.toString()}else t=this.valueDec.toString();return t}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.valueDec=this.valueDec,t.isFirstSid=this.isFirstSid,t}}class Z extends E{constructor(t={}){super(t),this.fromString(s(t,"value",""))}fromBER(t,e,r){let s=e;for(;r>0;){const e=new F;if(s=e.fromBER(t,s,r),-1===s)return this.blockLength=0,this.error=e.error,s;0===this.value.length&&(e.isFirstSid=!0),this.blockLength+=e.blockLength,r-=e.blockLength,this.value.push(e)}return s}toBER(t=!1){let e=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const s=this.value[r].toBER(t);if(0===s.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);e=c(e,s)}return e}fromString(t){this.value=[];let e=0,r=0,s="",i=!1;do{if(r=t.indexOf(".",e),s=-1===r?t.substr(e):t.substr(e,r-e),e=r+1,i){const t=this.value[0];let e=0;switch(t.valueDec){case 0:break;case 1:e=40;break;case 2:e=80;break;default:return this.value=[],!1}const r=parseInt(s,10);if(isNaN(r))return!0;t.valueDec=r+e,i=!1}else{const t=new F;if(t.valueDec=parseInt(s,10),isNaN(t.valueDec))return!0;0===this.value.length&&(t.isFirstSid=!0,i=!0),this.value.push(t)}}while(-1!==r);return!0}toString(){let t="",e=!1;for(let r=0;r<this.value.length;r++){e=this.value[r].isHexOnly;let s=this.value[r].toString();0!==r&&(t+="."),e?(s=`{${s}}`,this.value[r].isFirstSid?t=`2.{${s} - 80}`:t+=s):t+=s}return t}static blockName(){return"ObjectIdentifierValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}t.value=this.toString(),t.sidArray=[];for(let r=0;r<this.value.length;r++)t.sidArray.push(this.value[r].toJSON());return t}}class _ extends U{constructor(t={}){super(t,Z),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}static blockName(){return"OBJECT IDENTIFIER"}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.toString()}`}}class K extends(N(B)){constructor(t={}){super(t),this.isHexOnly=!0,this.value=""}static blockName(){return"Utf8StringValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.value=this.value,t}}class Q extends U{constructor(t={}){super(t,K),"value"in t&&this.fromString(t.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}static blockName(){return"UTF8String"}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(t));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`)}}fromString(t){const e=unescape(encodeURIComponent(t)),r=e.length;this.valueBlock.valueHex=new ArrayBuffer(r);const s=new Uint8Array(this.valueBlock.valueHex);for(let i=0;i<r;i++)s[i]=e.charCodeAt(i);this.valueBlock.value=t}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class X extends(N(B)){constructor(t={}){super(t),this.valueDec=s(t,"valueDec",-1)}static blockName(){return"relativeSidBlock"}fromBER(t,e,r){if(0===r)return e;if(!1===n(this,t,e,r))return-1;const s=new Uint8Array(t,e,r);this.valueHex=new ArrayBuffer(r);let i=new Uint8Array(this.valueHex);for(let n=0;n<r&&(i[n]=127&s[n],this.blockLength++,0!=(128&s[n]));n++);const a=new ArrayBuffer(this.blockLength),c=new Uint8Array(a);for(let n=0;n<this.blockLength;n++)c[n]=i[n];return this.valueHex=a.slice(0),i=new Uint8Array(this.valueHex),0!=(128&s[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===i[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=o(i,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),e+this.blockLength)}toBER(t=!1){let e,r;if(this.isHexOnly){if(!0===t)return new ArrayBuffer(this.valueHex.byteLength);const s=new Uint8Array(this.valueHex);e=new ArrayBuffer(this.blockLength),r=new Uint8Array(e);for(let t=0;t<this.blockLength-1;t++)r[t]=128|s[t];return r[this.blockLength-1]=s[this.blockLength-1],e}const s=a(this.valueDec,7);if(0===s.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(e=new ArrayBuffer(s.byteLength),!1===t){const t=new Uint8Array(s);r=new Uint8Array(e);for(let e=0;e<s.byteLength-1;e++)r[e]=128|t[e];r[s.byteLength-1]=t[s.byteLength-1]}return e}toString(){let t="";return t=!0===this.isHexOnly?i(this.valueHex,0,this.valueHex.byteLength):this.valueDec.toString(),t}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.valueDec=this.valueDec,t}}class Y extends E{constructor(t={}){super(t),this.fromString(s(t,"value",""))}fromBER(t,e,r){let s=e;for(;r>0;){const e=new X;if(s=e.fromBER(t,s,r),-1===s)return this.blockLength=0,this.error=e.error,s;this.blockLength+=e.blockLength,r-=e.blockLength,this.value.push(e)}return s}toBER(t=!1){let e=new ArrayBuffer(0);for(let r=0;r<this.value.length;r++){const s=this.value[r].toBER(t);if(0===s.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);e=c(e,s)}return e}fromString(t){this.value=[];let e=0,r=0,s="";do{r=t.indexOf(".",e),s=-1===r?t.substr(e):t.substr(e,r-e),e=r+1;const i=new X;if(i.valueDec=parseInt(s,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let t="",e=!1;for(let r=0;r<this.value.length;r++){e=this.value[r].isHexOnly;let s=this.value[r].toString();0!==r&&(t+="."),e?(s=`{${s}}`,t+=s):t+=s}return t}static blockName(){return"RelativeObjectIdentifierValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}t.value=this.toString(),t.sidArray=[];for(let r=0;r<this.value.length;r++)t.sidArray.push(this.value[r].toJSON());return t}}class tt extends U{constructor(t={}){super(t,Y),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}static blockName(){return"RelativeObjectIdentifier"}}class et extends(N(B)){constructor(t={}){super(t),this.isHexOnly=!0,this.value=""}static blockName(){return"BmpStringValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.value=this.value,t}}class rt extends U{constructor(t={}){super(t,et),"value"in t&&this.fromString(t.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}static blockName(){return"BMPString"}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}fromBuffer(t){const e=t.slice(0),r=new Uint8Array(e);for(let s=0;s<r.length;s+=2){const t=r[s];r[s]=r[s+1],r[s+1]=t}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(e))}fromString(t){const e=t.length;this.valueBlock.valueHex=new ArrayBuffer(2*e);const r=new Uint8Array(this.valueBlock.valueHex);for(let s=0;s<e;s++){const e=a(t.charCodeAt(s),8),i=new Uint8Array(e);if(i.length>2)continue;const n=2-i.length;for(let t=i.length-1;t>=0;t--)r[2*s+t+n]=i[t]}this.valueBlock.value=t}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class st extends(N(B)){constructor(t={}){super(t),this.isHexOnly=!0,this.value=""}static blockName(){return"UniversalStringValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.value=this.value,t}}class it extends U{constructor(t={}){super(t,st),"value"in t&&this.fromString(t.value),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}static blockName(){return"UniversalString"}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}fromBuffer(t){const e=t.slice(0),r=new Uint8Array(e);for(let s=0;s<r.length;s+=4)r[s]=r[s+3],r[s+1]=r[s+2],r[s+2]=0,r[s+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length;this.valueBlock.valueHex=new ArrayBuffer(4*e);const r=new Uint8Array(this.valueBlock.valueHex);for(let s=0;s<e;s++){const e=a(t.charCodeAt(s),8),i=new Uint8Array(e);if(i.length>4)continue;const n=4-i.length;for(let t=i.length-1;t>=0;t--)r[4*s+t+n]=i[t]}this.valueBlock.value=t}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class nt extends(N(B)){constructor(t={}){super(t),this.value="",this.isHexOnly=!0}static blockName(){return"SimpleStringValueBlock"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.value=this.value,t}}class ot extends U{constructor(t={}){super(t,nt),"value"in t&&this.fromString(t.value)}static blockName(){return"SIMPLESTRING"}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(t))}fromString(t){const e=t.length;this.valueBlock.valueHex=new ArrayBuffer(e);const r=new Uint8Array(this.valueBlock.valueHex);for(let s=0;s<e;s++)r[s]=t.charCodeAt(s);this.valueBlock.value=t}toString(){return`${this.constructor.blockName()} : ${this.valueBlock.value}`}}class at extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}static blockName(){return"NumericString"}}class ct extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}static blockName(){return"PrintableString"}}class ut extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}static blockName(){return"TeletexString"}}class ht extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}static blockName(){return"VideotexString"}}class ft extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}static blockName(){return"IA5String"}}class lt extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}static blockName(){return"GraphicString"}}class dt extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}static blockName(){return"VisibleString"}}class pt extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}static blockName(){return"GeneralString"}}class yt extends ot{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}static blockName(){return"CharacterString"}}class wt extends dt{constructor(t={}){if(super(t),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,"value"in t){this.fromString(t.value),this.valueBlock.valueHex=new ArrayBuffer(t.value.length);const e=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<t.value.length;r++)e[r]=t.value.charCodeAt(r)}"valueDate"in t&&(this.fromDate(t.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,new Uint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),r=new Uint8Array(e);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(t);if(null===e)return void(this.error="Wrong input string for convertion");const r=parseInt(e[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(e[2],10),this.day=parseInt(e[3],10),this.hour=parseInt(e[4],10),this.minute=parseInt(e[5],10),this.second=parseInt(e[6],10)}toString(){const t=new Array(7);return t[0]=l(this.year<2e3?this.year-1900:this.year-2e3,2),t[1]=l(this.month,2),t[2]=l(this.day,2),t[3]=l(this.hour,2),t[4]=l(this.minute,2),t[5]=l(this.second,2),t[6]="Z",t.join("")}static blockName(){return"UTCTime"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.year=this.year,t.month=this.month,t.day=this.day,t.hour=this.hour,t.minute=this.minute,t.second=this.second,t}}class mt extends dt{constructor(t={}){if(super(t),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,"value"in t){this.fromString(t.value),this.valueBlock.valueHex=new ArrayBuffer(t.value.length);const e=new Uint8Array(this.valueBlock.valueHex);for(let r=0;r<t.value.length;r++)e[r]=t.value.charCodeAt(r)}"valueDate"in t&&(this.fromDate(t.valueDate),this.valueBlock.valueHex=this.toBuffer()),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromBER(t,e,r){const s=this.valueBlock.fromBER(t,e,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===s?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),s)}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,new Uint8Array(t)))}toBuffer(){const t=this.toString(),e=new ArrayBuffer(t.length),r=new Uint8Array(e);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return e}fromDate(t){this.year=t.getUTCFullYear(),this.month=t.getUTCMonth()+1,this.day=t.getUTCDate(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds(),this.millisecond=t.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(t){let e,r=!1,s="",i="",n=0,o=0,a=0;if("Z"===t[t.length-1])s=t.substr(0,t.length-1),r=!0;else{const e=new Number(t[t.length-1]);if(isNaN(e.valueOf()))throw new Error("Wrong input string for convertion");s=t}if(r){if(-1!==s.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==s.indexOf("-"))throw new Error("Wrong input string for convertion")}else{let t=1,e=s.indexOf("+"),r="";if(-1===e&&(e=s.indexOf("-"),t=-1),-1!==e){if(r=s.substr(e+1),s=s.substr(0,e),2!==r.length&&4!==r.length)throw new Error("Wrong input string for convertion");let i=new Number(r.substr(0,2));if(isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");if(o=t*i,4===r.length){if(i=new Number(r.substr(2,2)),isNaN(i.valueOf()))throw new Error("Wrong input string for convertion");a=t*i}}}let c=s.indexOf(".");if(-1===c&&(c=s.indexOf(",")),-1!==c){const t=new Number("0"+s.substr(c));if(isNaN(t.valueOf()))throw new Error("Wrong input string for convertion");n=t.valueOf(),i=s.substr(0,c)}else i=s;switch(!0){case 8===i.length:if(e=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for convertion");break;case 10===i.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let t=60*n;this.minute=Math.floor(t),t=60*(t-this.minute),this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 12===i.length:if(e=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let t=60*n;this.second=Math.floor(t),t=1e3*(t-this.second),this.millisecond=Math.floor(t)}break;case 14===i.length:e=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c&&(this.millisecond=Math.floor(1e3*n));break;default:throw new Error("Wrong input string for convertion")}const u=e.exec(i);if(null===u)throw new Error("Wrong input string for convertion");for(let h=1;h<u.length;h++)switch(h){case 1:this.year=parseInt(u[h],10);break;case 2:this.month=parseInt(u[h],10);break;case 3:this.day=parseInt(u[h],10);break;case 4:this.hour=parseInt(u[h],10)+o;break;case 5:this.minute=parseInt(u[h],10)+a;break;case 6:this.second=parseInt(u[h],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===r){const t=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=t.getUTCFullYear(),this.month=t.getUTCMonth(),this.day=t.getUTCDay(),this.hour=t.getUTCHours(),this.minute=t.getUTCMinutes(),this.second=t.getUTCSeconds(),this.millisecond=t.getUTCMilliseconds()}}toString(){const t=[];return t.push(l(this.year,4)),t.push(l(this.month,2)),t.push(l(this.day,2)),t.push(l(this.hour,2)),t.push(l(this.minute,2)),t.push(l(this.second,2)),0!==this.millisecond&&(t.push("."),t.push(l(this.millisecond,3))),t.push("Z"),t.join("")}static blockName(){return"GeneralizedTime"}toJSON(){let t={};try{t=super.toJSON()}catch(e){}return t.year=this.year,t.month=this.month,t.day=this.day,t.hour=this.hour,t.minute=this.minute,t.second=this.second,t.millisecond=this.millisecond,t}}class vt extends Q{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}static blockName(){return"DATE"}}class gt extends Q{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}static blockName(){return"TimeOfDay"}}class At extends Q{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}static blockName(){return"DateTime"}}class bt extends Q{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}static blockName(){return"Duration"}}class St extends Q{constructor(t={}){super(t),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}static blockName(){return"TIME"}}class Bt{constructor(t={}){this.value=s(t,"value",[]),this.optional=s(t,"optional",!1)}}class Nt{constructor(t={}){this.name=s(t,"name",""),this.optional=s(t,"optional",!1)}}class kt{constructor(t={}){this.name=s(t,"name",""),this.optional=s(t,"optional",!1),this.value=s(t,"value",new Nt),this.local=s(t,"local",!1)}}class xt{constructor(t={}){this.data=s(t,"data",new ArrayBuffer(0))}fromBER(t,e,r){return this.data=t.slice(e,r),e+r}toBER(t=!1){return this.data}}function Et(t,e,r){const s=e;let i=new U({},Object);const o=new B;if(!1===n(o,t,e,r))return i.error=o.error,{offset:-1,result:i};if(0===new Uint8Array(t,e,r).length)return i.error="Zero buffer length",{offset:-1,result:i};let a=i.idBlock.fromBER(t,e,r);if(i.warnings.concat(i.idBlock.warnings),-1===a)return i.error=i.idBlock.error,{offset:-1,result:i};if(a=i.lenBlock.fromBER(t,e=a,r-=i.idBlock.blockLength),i.warnings.concat(i.lenBlock.warnings),-1===a)return i.error=i.lenBlock.error,{offset:-1,result:i};if(e=a,r-=i.lenBlock.blockLength,!1===i.idBlock.isConstructed&&!0===i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let c=U;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(!0===i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};c=j;break;case 1:c=D;break;case 2:c=L;break;case 3:c=z;break;case 4:c=H;break;case 5:c=W;break;case 6:c=_;break;case 10:c=q;break;case 12:c=Q;break;case 13:c=tt;break;case 14:c=St;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:c=V;break;case 17:c=P;break;case 18:c=at;break;case 19:c=ct;break;case 20:c=ut;break;case 21:c=ht;break;case 22:c=ft;break;case 23:c=wt;break;case 24:c=mt;break;case 25:c=lt;break;case 26:c=dt;break;case 27:c=pt;break;case 28:c=it;break;case 29:c=yt;break;case 30:c=rt;break;case 31:c=vt;break;case 32:c=gt;break;case 33:c=At;break;case 34:c=bt;break;default:{let t;t=!0===i.idBlock.isConstructed?new T:new I,t.idBlock=i.idBlock,t.lenBlock=i.lenBlock,t.warnings=i.warnings,i=t}}break;case 2:case 3:case 4:default:c=!0===i.idBlock.isConstructed?T:I}return i=function(t,e){if(t instanceof e)return t;const r=new e;return r.idBlock=t.idBlock,r.lenBlock=t.lenBlock,r.warnings=t.warnings,r.valueBeforeDecode=t.valueBeforeDecode.slice(0),r}(i,c),a=i.fromBER(t,e,!0===i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecode=t.slice(s,s+i.blockLength),{offset:a,result:i}}function Ut(t){if(0===t.byteLength){const t=new U({},Object);return t.error="Input buffer has zero length",{offset:-1,result:t}}return Et(t,0,t.byteLength)}function Ot(t,e,r){if(r instanceof Bt){for(let s=0;s<r.value.length;s++)if(!0===Ot(t,e,r.value[s]).verified)return{verified:!0,result:t};{const t={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(t.name=r.name),t}}if(r instanceof Nt)return r.hasOwnProperty("name")&&(t[r.name]=e),{verified:!0,result:t};if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong root object"}};if(e instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const s=r.idBlock.toBER(!1);if(0===s.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(s,0,s.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==e.idBlock.tagClass)return{verified:!1,result:t};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==e.idBlock.tagNumber)return{verified:!1,result:t};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==e.idBlock.isConstructed)return{verified:!1,result:t};if("isHexOnly"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==e.idBlock.isHexOnly)return{verified:!1,result:t};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const s=new Uint8Array(r.idBlock.valueHex),i=new Uint8Array(e.idBlock.valueHex);if(s.length!==i.length)return{verified:!1,result:t};for(let e=0;e<s.length;e++)if(s[e]!==i[1])return{verified:!1,result:t}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(t[r.name]=e)),!0===r.idBlock.isConstructed){let s=0,i={verified:!1},n=r.valueBlock.value.length;if(n>0&&r.valueBlock.value[0]instanceof kt&&(n=e.valueBlock.value.length),0===n)return{verified:!0,result:t};if(0===e.valueBlock.value.length&&0!==r.valueBlock.value.length){let e=!0;for(let t=0;t<r.valueBlock.value.length;t++)e=e&&(r.valueBlock.value[t].optional||!1);return!0===e?{verified:!0,result:t}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete t[r.name]),t.error="Inconsistent object length",{verified:!1,result:t})}for(let o=0;o<n;o++)if(o-s>=e.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){const e={verified:!1,result:t};return t.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete t[r.name],e.name=r.name)),e}}else if(r.valueBlock.value[0]instanceof kt){if(i=Ot(t,e.valueBlock.value[o],r.valueBlock.value[0].value),!1===i.verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete t[r.name]),i;s++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let s={};s="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?e:t,void 0===s[r.valueBlock.value[0].name]&&(s[r.valueBlock.value[0].name]=[]),s[r.valueBlock.value[0].name].push(e.valueBlock.value[o])}}else if(i=Ot(t,e.valueBlock.value[o-s],r.valueBlock.value[o]),!1===i.verified){if(!0!==r.valueBlock.value[o].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete t[r.name]),i;s++}if(!1===i.verified){const e={verified:!1,result:t};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete t[r.name],e.name=r.name)),e}return{verified:!0,result:t}}if("primitiveSchema"in r&&"valueHex"in e.valueBlock){const s=Ut(e.valueBlock.valueHex);if(-1===s.offset){const e={verified:!1,result:s.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete t[r.name],e.name=r.name)),e}return Ot(t,s.result,r.primitiveSchema)}return{verified:!0,result:t}}const It=Object.freeze({__proto__:null,HexBlock:N,ValueBlock:E,BaseBlock:U,Primitive:I,Constructed:T,EndOfContent:j,Boolean:D,Sequence:V,Set:P,Null:W,OctetString:H,BitString:z,Integer:L,Enumerated:q,ObjectIdentifier:_,Utf8String:Q,RelativeObjectIdentifier:tt,BmpString:rt,UniversalString:it,NumericString:at,PrintableString:ct,TeletexString:ut,VideotexString:ht,IA5String:ft,GraphicString:lt,VisibleString:dt,GeneralString:pt,CharacterString:yt,UTCTime:wt,GeneralizedTime:mt,DATE:vt,TimeOfDay:gt,DateTime:At,Duration:bt,TIME:St,Choice:Bt,Any:Nt,Repeated:kt,RawData:xt,fromBER:Ut,compareSchema:Ot,verifySchema:function(t,e){if(e instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=Ut(t);return-1===r.offset?{verified:!1,result:r.result}:Ot(r.result,r.result,e)},fromJSON:function(){}});var Rt,Tt;!function(t){t[t.Sequence=0]="Sequence",t[t.Set=1]="Set",t[t.Choice=2]="Choice"}(Rt||(Rt={})),function(t){t[t.Any=1]="Any",t[t.Boolean=2]="Boolean",t[t.OctetString=3]="OctetString",t[t.BitString=4]="BitString",t[t.Integer=5]="Integer",t[t.Enumerated=6]="Enumerated",t[t.ObjectIdentifier=7]="ObjectIdentifier",t[t.Utf8String=8]="Utf8String",t[t.BmpString=9]="BmpString",t[t.UniversalString=10]="UniversalString",t[t.NumericString=11]="NumericString",t[t.PrintableString=12]="PrintableString",t[t.TeletexString=13]="TeletexString",t[t.VideotexString=14]="VideotexString",t[t.IA5String=15]="IA5String",t[t.GraphicString=16]="GraphicString",t[t.VisibleString=17]="VisibleString",t[t.GeneralString=18]="GeneralString",t[t.CharacterString=19]="CharacterString",t[t.UTCTime=20]="UTCTime",t[t.GeneralizedTime=21]="GeneralizedTime",t[t.DATE=22]="DATE",t[t.TimeOfDay=23]="TimeOfDay",t[t.DateTime=24]="DateTime",t[t.Duration=25]="Duration",t[t.TIME=26]="TIME",t[t.Null=27]="Null"}(Tt||(Tt={}));const $t={fromASN:t=>t instanceof W?null:t.valueBeforeDecode,toASN:t=>{if(null===t)return new W;const e=Ut(t);if(e.result.error)throw new Error(e.result.error);return e.result}},jt={fromASN:t=>t.valueBlock.valueHex.byteLength>4?t.valueBlock.toString():t.valueBlock.valueDec,toASN:t=>new L({value:t})},Ct={fromASN:t=>t.valueBlock.valueDec,toASN:t=>new q({value:t})},Dt={fromASN:t=>t.valueBlock.valueHex,toASN:t=>new L({valueHex:t})},Vt={fromASN:t=>t.valueBlock.valueHex,toASN:t=>new z({valueHex:t})},Pt={fromASN:t=>t.valueBlock.toString(),toASN:t=>new _({value:t})},Wt={fromASN:t=>t.valueBlock.value,toASN:t=>new D({value:t})},Mt={fromASN:t=>t.valueBlock.valueHex,toASN:t=>new H({valueHex:t})};function Ht(t){return{fromASN:t=>t.valueBlock.value,toASN:e=>new t({value:e})}}const Jt=Ht(Q),zt=Ht(rt),Gt=Ht(it),Lt=Ht(at),qt=Ht(ct),Ft=Ht(ut),Zt=Ht(ht),_t=Ht(ft),Kt=Ht(lt),Qt=Ht(dt),Xt=Ht(pt),Yt=Ht(yt),te={fromASN:t=>t.toDate(),toASN:t=>new wt({valueDate:t})},ee={fromASN:t=>t.toDate(),toASN:t=>new mt({valueDate:t})},re={fromASN:()=>null,toASN:()=>new W};function se(t){switch(t){case Tt.Any:return $t;case Tt.BitString:return Vt;case Tt.BmpString:return zt;case Tt.Boolean:return Wt;case Tt.CharacterString:return Yt;case Tt.Enumerated:return Ct;case Tt.GeneralString:return Xt;case Tt.GeneralizedTime:return ee;case Tt.GraphicString:return Kt;case Tt.IA5String:return _t;case Tt.Integer:return jt;case Tt.Null:return re;case Tt.NumericString:return Lt;case Tt.ObjectIdentifier:return Pt;case Tt.OctetString:return Mt;case Tt.PrintableString:return qt;case Tt.TeletexString:return Ft;case Tt.UTCTime:return te;case Tt.UniversalString:return Gt;case Tt.Utf8String:return Jt;case Tt.VideotexString:return Zt;case Tt.VisibleString:return Qt;default:return null}}const ie=r(t((function(t,e){!function(t){class e{static isArrayBuffer(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)}static toArrayBuffer(t){const e=this.toUint8Array(t);return e.byteOffset||e.length?e.buffer.slice(e.byteOffset,e.byteOffset+e.length):e.buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if("undefined"!=typeof Buffer&&Buffer.isBuffer(t))return new e(t.buffer,t.byteOffset,t.byteLength);if(this.isArrayBuffer(t))return new e(t);if(this.isArrayBufferView(t))return new e(t.buffer,t.byteOffset,t.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}}class r{static isHex(t){return"string"==typeof t&&/^[a-z0-9]+$/i.test(t)}static isBase64(t){return"string"==typeof t&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}static isBase64Url(t){return"string"==typeof t&&/^[a-zA-Z0-9-_]+$/i.test(t)}static ToString(t,r="utf8"){const s=e.toUint8Array(t);switch(r.toLowerCase()){case"utf8":return this.ToUtf8String(s);case"binary":return this.ToBinary(s);case"hex":return this.ToHex(s);case"base64":return this.ToBase64(s);case"base64url":return this.ToBase64Url(s);default:throw new Error(`Unknown type of encoding '${r}'`)}}static FromString(t,e="utf8"){if(!t)return new ArrayBuffer(0);switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToBase64(t){const r=e.toUint8Array(t);if("undefined"!=typeof btoa){const t=this.ToString(r,"binary");return btoa(t)}return Buffer.from(r).toString("base64")}static FromBase64(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!r.isBase64(e))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(e)):new Uint8Array(Buffer.from(e,"base64")).buffer}static FromBase64Url(t){const e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!r.isBase64Url(e))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t){const e=unescape(encodeURIComponent(t)),r=new Uint8Array(e.length);for(let s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return r.buffer}static ToUtf8String(t){const r=e.toUint8Array(t),s=String.fromCharCode.apply(null,r);return decodeURIComponent(escape(s))}static FromBinary(t){const e=t.length,r=new Uint8Array(e);for(let s=0;s<e;s++)r[s]=t.charCodeAt(s);return r.buffer}static ToBinary(t){const r=e.toUint8Array(t);return String.fromCharCode.apply(null,r)}static ToHex(t){const r=e.toUint8Array(t),s=[],i=r.length;for(let e=0;e<i;e++){const t=r[e].toString(16).padStart(2,"0");s.push(t)}return s.join("")}static FromHex(t){let e=this.formatString(t);if(!e)return new ArrayBuffer(0);if(!r.isHex(e))throw new TypeError("Argument 'hexString' is not HEX encoded");e.length%2&&(e="0"+e);const s=new Uint8Array(e.length/2);for(let r=0;r<e.length;r+=2){const t=e.slice(r,r+2);s[r/2]=parseInt(t,16)}return s.buffer}static Base64Padding(t){const e=4-t.length%4;if(e<4)for(let r=0;r<e;r++)t+="=";return t}static formatString(t){return(null==t?void 0:t.replace(/[\n\r\t ]/g,""))||""}}t.BufferSourceConverter=e,t.Convert=r,t.assign=function(t){const e=arguments[0];for(let r=1;r<arguments.length;r++){const t=arguments[r];for(const r in t)e[r]=t[r]}return e},t.combine=function(...t){const e=t.map(t=>t.byteLength).reduce((t,e)=>t+e),r=new Uint8Array(e);let s=0;return t.map(t=>new Uint8Array(t)).forEach(t=>{for(const e of t)r[s++]=e}),r.buffer},t.isEqual=function(t,e){if(!t||!e)return!1;if(t.byteLength!==e.byteLength)return!1;const r=new Uint8Array(t),s=new Uint8Array(e);for(let i=0;i<t.byteLength;i++)if(r[i]!==s[i])return!1;return!0},Object.defineProperty(t,"__esModule",{value:!0})}(e)})));class ne{constructor(t,e=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),t)if("number"==typeof t)this.fromNumber(t);else{if(!ie.BufferSourceConverter.isBufferSource(t))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=e,this.value=ie.BufferSourceConverter.toArrayBuffer(t)}}fromASN(t){if(!(t instanceof z))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=t.valueBlock.unusedBits,this.value=t.valueBlock.valueHex,this}toASN(){return new z({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(t){return new z({name:t})}toNumber(){let t="";const e=new Uint8Array(this.value);for(const r of e)t+=r.toString(2).padStart(8,"0");return t=t.split("").reverse().join(""),this.unusedBits&&(t=t.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(t,2)}fromNumber(t){let e=t.toString(2);const r=e.length+7>>3;this.unusedBits=(r<<3)-e.length;const s=new Uint8Array(r);e=e.padStart(r<<3,"0").split("").reverse().join("");let i=0;for(;i<r;)s[i]=parseInt(e.slice(i<<3,8+(i<<3)),2),i++;this.value=s.buffer}}class oe{constructor(t){this.buffer="number"==typeof t?new ArrayBuffer(t):ie.BufferSourceConverter.isBufferSource(t)?ie.BufferSourceConverter.toArrayBuffer(t):Array.isArray(t)?new Uint8Array(t):new ArrayBuffer(0)}get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}fromASN(t){if(!(t instanceof H))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=t.valueBlock.valueHex,this}toASN(){return new H({valueHex:this.buffer})}toSchema(t){return new H({name:t})}}function ae(t){return t&&t.prototype?!(!t.prototype.toASN||!t.prototype.fromASN)||ae(t.prototype):!!(t&&t.toASN&&t.fromASN)}function ce(t,e){if(!t||!e)return!1;if(t.byteLength!==e.byteLength)return!1;const r=new Uint8Array(t),s=new Uint8Array(e);for(let i=0;i<t.byteLength;i++)if(r[i]!==s[i])return!1;return!0}const ue=new class{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t){var e,r,s,i;const n=this.items.get(t);if(!n)throw new Error(`Cannot get schema for '${null!==(i=null===(s=null===(r=null===(e=t)||void 0===e?void 0:e.prototype)||void 0===r?void 0:r.constructor)||void 0===s?void 0:s.name)&&void 0!==i?i:t}' target`);return n}cache(t){const e=this.get(t);e.schema||(e.schema=this.create(t,!0))}createDefault(t){const e={type:Rt.Sequence,items:{}},r=this.findParentSchema(t);return r&&(Object.assign(e,r),e.items=Object.assign({},e.items,r.items)),e}create(t,e){const r=this.items.get(t)||this.createDefault(t),s=[];for(const i in r.items){const t=r.items[i],n=e?i:"";let o;if("number"==typeof t.type){const e=Tt[t.type],r=It[e];if(!r)throw new Error(`Cannot get ASN1 class by name '${e}'`);o=new r({name:n})}else ae(t.type)?o=(new t.type).toSchema(n):t.optional?this.get(t.type).type===Rt.Choice?o=new Nt({name:n}):(o=this.create(t.type,!1),o.name=n):o=new Nt({name:n});const a=!!t.optional||void 0!==t.defaultValue;if(t.repeated&&(o.name="",o=new("set"===t.repeated?P:V)({name:"",value:[new kt({name:n,value:o})]})),null!=t.context)if(t.implicit)if("number"==typeof t.type||ae(t.type))s.push(new(t.repeated?T:I)({name:n,optional:a,idBlock:{tagClass:3,tagNumber:t.context}}));else{this.cache(t.type);const e=!!t.repeated;let r=e?o:this.get(t.type).schema;r=r.valueBlock?r.valueBlock.value:r.value,s.push(new T({name:e?"":n,optional:a,idBlock:{tagClass:3,tagNumber:t.context},value:r}))}else s.push(new T({optional:a,idBlock:{tagClass:3,tagNumber:t.context},value:[o]}));else o.optional=a,s.push(o)}switch(r.type){case Rt.Sequence:return new V({value:s,name:""});case Rt.Set:return new P({value:s,name:""});case Rt.Choice:return new Bt({value:s,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(t,e){return this.items.set(t,e),this}findParentSchema(t){const e=t.__proto__;return e?this.items.get(e)||this.findParentSchema(e):null}},he=t=>e=>{let r;ue.has(e)?r=ue.get(e):(r=ue.createDefault(e),ue.set(e,r)),Object.assign(r,t)},fe=t=>(e,r)=>{let s;ue.has(e.constructor)?s=ue.get(e.constructor):(s=ue.createDefault(e.constructor),ue.set(e.constructor,s));const i=Object.assign({},t);if("number"==typeof i.type&&!i.converter){const s=se(t.type);if(!s)throw new Error(`Cannot get default converter for property '${r}' of ${e.constructor.name}`);i.converter=s}s.items[r]=i};class le extends Error{constructor(){super(...arguments),this.schemas=[]}}class de{static parse(t,e){let r;if(t instanceof ArrayBuffer)r=t;else if("undefined"!=typeof Buffer&&Buffer.isBuffer(t))r=new Uint8Array(t).buffer;else{if(!(ArrayBuffer.isView(t)||t.buffer instanceof ArrayBuffer))throw new TypeError("Wrong type of 'data' argument");r=t.buffer}const s=Ut(r);if(s.result.error)throw new Error(s.result.error);return this.fromASN(s.result,e)}static fromASN(t,e){var r;try{if(ae(e))return(new e).fromASN(t);const s=ue.get(e);ue.cache(e);let i=s.schema;if(t.constructor===T&&s.type!==Rt.Choice){i=new T({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:s.schema.valueBlock.value});for(const e in s.items)delete t[e]}const n=Ot(t,t,i);if(!n.verified)throw new le(`Data does not match to ${e.name} ASN1 schema. ${n.result.error}`);const o=new e;if(function t(e){var r;if(e){const s=Object.getPrototypeOf(e);return(null===(r=null==s?void 0:s.prototype)||void 0===r?void 0:r.constructor)===Array||t(s)}return!1}(e)){if("number"==typeof s.itemType){const r=se(s.itemType);if(!r)throw new Error(`Cannot get default converter for array item of ${e.name} ASN1 schema`);return e.from(t.valueBlock.value,t=>r.fromASN(t))}return e.from(t.valueBlock.value,t=>this.fromASN(t,s.itemType))}for(const e in s.items){if(!t[e])continue;const i=s.items[e];if("number"==typeof i.type||ae(i.type)){const s=null!==(r=i.converter)&&void 0!==r?r:ae(i.type)?new i.type:null;if(!s)throw new Error("Converter is empty");if(i.repeated)if(i.implicit){const r=new("sequence"===i.repeated?V:P);r.valueBlock=t[e].valueBlock;const n=Ut(r.toBER(!1)).result.valueBlock.value;o[e]=Array.from(n,t=>s.fromASN(t))}else o[e]=Array.from(t[e],t=>s.fromASN(t));else{let r=t[e];if(i.implicit){let t;if(ae(i.type))t=(new i.type).toSchema("");else{const e=Tt[i.type],r=It[e];if(!r)throw new Error(`Cannot get '${e}' class from asn1js module`);t=new r}t.valueBlock=r.valueBlock,r=Ut(t.toBER(!1)).result}o[e]=s.fromASN(r)}}else o[e]=i.repeated?Array.from(t[e],t=>this.fromASN(t,i.type)):this.fromASN(t[e],i.type)}return o}catch(s){throw s instanceof le&&s.schemas.push(e.name),s}}}class pe{static serialize(t){return t instanceof U?t.toBER(!1):this.toASN(t).toBER(!1)}static toASN(t){if(t&&ae(t.constructor))return t.toASN();const e=t.constructor,r=ue.get(e);ue.cache(e);let s,i=[];if(r.itemType)if("number"==typeof r.itemType){const s=se(r.itemType);if(!s)throw new Error(`Cannot get default converter for array item of ${e.name} ASN1 schema`);i=t.map(t=>s.toASN(t))}else i=t.map(t=>this.toAsnItem({type:r.itemType},"[]",e,t));else for(const n in r.items){const s=r.items[n],o=t[n];if(void 0===o||s.defaultValue===o||"object"==typeof s.defaultValue&&"object"==typeof o&&ce(this.serialize(s.defaultValue),this.serialize(o)))continue;let a=pe.toAsnItem(s,n,e,o);if("number"==typeof s.context)if(s.implicit)if(s.repeated||"number"!=typeof s.type&&!ae(s.type))i.push(new T({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:a.valueBlock.value}));else{const t={};t.valueHex=a instanceof W?a.valueBeforeDecode:a.valueBlock.toBER(),i.push(new I(Object.assign({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context}},t)))}else i.push(new T({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else s.repeated?i=i.concat(a):i.push(a)}switch(r.type){case Rt.Sequence:s=new V({value:i});break;case Rt.Set:s=new P({value:i});break;case Rt.Choice:if(!i[0])throw new Error(`Schema '${e.name}' has wrong data. Choice cannot be empty.`);s=i[0]}return s}static toAsnItem(t,e,r,s){let i;if("number"==typeof t.type){const n=t.converter;if(!n)throw new Error(`Property '${e}' doesn't have converter for type ${Tt[t.type]} in schema '${r.name}'`);if(t.repeated){const e=Array.from(s,t=>n.toASN(t));i=new("sequence"===t.repeated?V:P)({value:e})}else i=n.toASN(s)}else if(t.repeated){const e=Array.from(s,t=>this.toASN(t));i=new("sequence"===t.repeated?V:P)({value:e})}else i=this.toASN(s);return i}}class ye extends Array{constructor(t=[]){if("number"==typeof t)super(t);else{super();for(const e of t)this.push(e)}}}class we{static serialize(t){return pe.serialize(t)}static parse(t,e){return de.parse(t,e)}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function me(t,e,r,s){var i,n=arguments.length,o=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,s);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(n<3?i(o):n>3?i(e,r,o):i(e,r))||o);return n>3&&o&&Object.defineProperty(e,r,o),o}var ve,ge,Ae,be=t((function(t){!function(e){const r="(0?\\d+|0x[a-f0-9]+)",s={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},i=new RegExp("^0[0-7]+$","i"),n=new RegExp("^0x[a-f0-9]+$","i"),o="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp("%[0-9a-z]{1,}","i"),native:new RegExp(`^(::)?(${o})?([0-9a-f]+)?(::)?(%[0-9a-z]{1,})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(%[0-9a-z]{1,})?)$`,"i"),transitional:new RegExp(`^((?:${o})|(?:::)(?:${o})?)${r}\\.${r}\\.${r}\\.${r}(%[0-9a-z]{1,})?$`,"i")};function c(t,e){if(t.indexOf("::")!==t.lastIndexOf("::"))return null;let r,s,i=0,n=-1,o=(t.match(a.zoneIndex)||[])[0];for(o&&(o=o.substring(1),t=t.replace(/%.+$/,""));(n=t.indexOf(":",n+1))>=0;)i++;if("::"===t.substr(0,2)&&i--,"::"===t.substr(-2,2)&&i--,i>e)return null;for(s=e-i,r=":";s--;)r+="0:";return":"===(t=t.replace("::",r))[0]&&(t=t.slice(1)),":"===t[t.length-1]&&(t=t.slice(0,-1)),{parts:e=function(){const e=t.split(":"),r=[];for(let t=0;t<e.length;t++)r.push(parseInt(e[t],16));return r}(),zoneId:o}}function u(t,e,r,s){if(t.length!==e.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,n=0;for(;s>0;){if(i=r-s,i<0&&(i=0),t[n]>>i!=e[n]>>i)return!1;s-=r,n+=1}return!0}function h(t){if(n.test(t))return parseInt(t,16);if("0"===t[0]&&!isNaN(parseInt(t[1],10))){if(i.test(t))return parseInt(t,8);throw new Error(`ipaddr: cannot parse ${t} as octal`)}return parseInt(t,10)}function f(t,e){for(;t.length<e;)t="0"+t;return t}const l={};l.IPv4=function(){function t(t){if(4!==t.length)throw new Error("ipaddr: ipv4 octet count should be 4");let e,r;for(e=0;e<t.length;e++)if(r=t[e],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=t}return t.prototype.SpecialRanges={unspecified:[[new t([0,0,0,0]),8]],broadcast:[[new t([255,255,255,255]),32]],multicast:[[new t([224,0,0,0]),4]],linkLocal:[[new t([169,254,0,0]),16]],loopback:[[new t([127,0,0,0]),8]],carrierGradeNat:[[new t([100,64,0,0]),10]],private:[[new t([10,0,0,0]),8],[new t([172,16,0,0]),12],[new t([192,168,0,0]),16]],reserved:[[new t([192,0,0,0]),24],[new t([192,0,2,0]),24],[new t([192,88,99,0]),24],[new t([198,51,100,0]),24],[new t([203,0,113,0]),24],[new t([240,0,0,0]),4]]},t.prototype.kind=function(){return"ipv4"},t.prototype.match=function(t,e){let r;if(void 0===e&&(r=t,t=r[0],e=r[1]),"ipv4"!==t.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return u(this.octets,t.octets,8,e)},t.prototype.prefixLengthFromSubnetMask=function(){let t=0,e=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let s,i,n;for(s=3;s>=0;s-=1){if(i=this.octets[s],!(i in r))return null;if(n=r[i],e&&0!==n)return null;8!==n&&(e=!0),t+=n}return 32-t},t.prototype.range=function(){return l.subnetMatch(this,this.SpecialRanges)},t.prototype.toByteArray=function(){return this.octets.slice(0)},t.prototype.toIPv4MappedAddress=function(){return l.IPv6.parse("::ffff:"+this.toString())},t.prototype.toNormalizedString=function(){return this.toString()},t.prototype.toString=function(){return this.octets.join(".")},t}(),l.IPv4.broadcastAddressFromCIDR=function(t){try{const e=this.parseCIDR(t),r=e[0].toByteArray(),s=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),i=[];let n=0;for(;n<4;)i.push(parseInt(r[n],10)|255^parseInt(s[n],10)),n++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},l.IPv4.isIPv4=function(t){return null!==this.parser(t)},l.IPv4.isValid=function(t){try{return new this(this.parser(t)),!0}catch(e){return!1}},l.IPv4.isValidFourPartDecimal=function(t){return!(!l.IPv4.isValid(t)||!t.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},l.IPv4.networkAddressFromCIDR=function(t){let e,r,s,i,n;try{for(e=this.parseCIDR(t),s=e[0].toByteArray(),n=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),i=[],r=0;r<4;)i.push(parseInt(s[r],10)&parseInt(n[r],10)),r++;return new this(i)}catch(o){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},l.IPv4.parse=function(t){const e=this.parser(t);if(null===e)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(e)},l.IPv4.parseCIDR=function(t){let e;if(e=t.match(/^(.+)\/(\d+)$/)){const t=parseInt(e[2]);if(t>=0&&t<=32){const r=[this.parse(e[1]),t];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},l.IPv4.parser=function(t){let e,r,i;if(e=t.match(s.fourOctet))return function(){const t=e.slice(1,6),s=[];for(let e=0;e<t.length;e++)r=t[e],s.push(h(r));return s}();if(e=t.match(s.longValue)){if(i=h(e[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const t=[];let e;for(e=0;e<=24;e+=8)t.push(i>>e&255);return t}().reverse()}return(e=t.match(s.twoOctet))?function(){const t=e.slice(1,4),r=[];if(i=h(t[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(t[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(e=t.match(s.threeOctet))?function(){const t=e.slice(1,5),r=[];if(i=h(t[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(h(t[0])),r.push(h(t[1])),r.push(i>>8&255),r.push(255&i),r}():null},l.IPv4.subnetMaskFromPrefixLength=function(t){if((t=parseInt(t))<0||t>32)throw new Error("ipaddr: invalid IPv4 prefix length");const e=[0,0,0,0];let r=0;const s=Math.floor(t/8);for(;r<s;)e[r]=255,r++;return s<4&&(e[s]=Math.pow(2,t%8)-1<<8-t%8),new this(e)},l.IPv6=function(){function t(t,e){let r,s;if(16===t.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(t[r]<<8|t[r+1]);else{if(8!==t.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=t}for(r=0;r<this.parts.length;r++)if(s=this.parts[r],!(0<=s&&s<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");e&&(this.zoneId=e)}return t.prototype.SpecialRanges={unspecified:[new t([0,0,0,0,0,0,0,0]),128],linkLocal:[new t([65152,0,0,0,0,0,0,0]),10],multicast:[new t([65280,0,0,0,0,0,0,0]),8],loopback:[new t([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new t([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new t([0,0,0,0,0,65535,0,0]),96],rfc6145:[new t([0,0,0,0,65535,0,0,0]),96],rfc6052:[new t([100,65435,0,0,0,0,0,0]),96],"6to4":[new t([8194,0,0,0,0,0,0,0]),16],teredo:[new t([8193,0,0,0,0,0,0,0]),32],reserved:[[new t([8193,3512,0,0,0,0,0,0]),32]]},t.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},t.prototype.kind=function(){return"ipv6"},t.prototype.match=function(t,e){let r;if(void 0===e&&(r=t,t=r[0],e=r[1]),"ipv6"!==t.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return u(this.parts,t.parts,16,e)},t.prototype.prefixLengthFromSubnetMask=function(){let t=0,e=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let s,i;for(let n=7;n>=0;n-=1){if(s=this.parts[n],!(s in r))return null;if(i=r[s],e&&0!==i)return null;16!==i&&(e=!0),t+=i}return 128-t},t.prototype.range=function(){return l.subnetMatch(this,this.SpecialRanges)},t.prototype.toByteArray=function(){let t;const e=[],r=this.parts;for(let s=0;s<r.length;s++)t=r[s],e.push(t>>8),e.push(255&t);return e},t.prototype.toFixedLengthString=function(){const t=function(){const t=[];for(let e=0;e<this.parts.length;e++)t.push(f(this.parts[e].toString(16),4));return t}.call(this).join(":");let e="";return this.zoneId&&(e="%"+this.zoneId),t+e},t.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const t=this.parts.slice(-2),e=t[0],r=t[1];return new l.IPv4([e>>8,255&e,r>>8,255&r])},t.prototype.toNormalizedString=function(){const t=function(){const t=[];for(let e=0;e<this.parts.length;e++)t.push(this.parts[e].toString(16));return t}.call(this).join(":");let e="";return this.zoneId&&(e="%"+this.zoneId),t+e},t.prototype.toRFC5952String=function(){const t=/((^|:)(0(:|$)){2,})/g,e=this.toNormalizedString();let r,s=0,i=-1;for(;r=t.exec(e);)r[0].length>i&&(s=r.index,i=r[0].length);return i<0?e:`${e.substring(0,s)}::${e.substring(s+i)}`},t.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},t}(),l.IPv6.isIPv6=function(t){return null!==this.parser(t)},l.IPv6.isValid=function(t){if("string"==typeof t&&-1===t.indexOf(":"))return!1;try{const e=this.parser(t);return new this(e.parts,e.zoneId),!0}catch(e){return!1}},l.IPv6.parse=function(t){const e=this.parser(t);if(null===e.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(e.parts,e.zoneId)},l.IPv6.parseCIDR=function(t){let e,r,s;if((r=t.match(/^(.+)\/(\d+)$/))&&(e=parseInt(r[2]),e>=0&&e<=128))return s=[this.parse(r[1]),e],Object.defineProperty(s,"toString",{value:function(){return this.join("/")}}),s;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},l.IPv6.parser=function(t){let e,r,s,i,n,o;if(s=t.match(a.deprecatedTransitional))return this.parser("::ffff:"+s[1]);if(a.native.test(t))return c(t,8);if((s=t.match(a.transitional))&&(o=s[6]||"",e=c(s[1].slice(0,-1)+o,6),e.parts)){for(n=[parseInt(s[2]),parseInt(s[3]),parseInt(s[4]),parseInt(s[5])],r=0;r<n.length;r++)if(i=n[r],!(0<=i&&i<=255))return null;return e.parts.push(n[0]<<8|n[1]),e.parts.push(n[2]<<8|n[3]),{parts:e.parts,zoneId:e.zoneId}}return null},l.fromByteArray=function(t){const e=t.length;if(4===e)return new l.IPv4(t);if(16===e)return new l.IPv6(t);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},l.isValid=function(t){return l.IPv6.isValid(t)||l.IPv4.isValid(t)},l.parse=function(t){if(l.IPv6.isValid(t))return l.IPv6.parse(t);if(l.IPv4.isValid(t))return l.IPv4.parse(t);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},l.parseCIDR=function(t){try{return l.IPv6.parseCIDR(t)}catch(e){try{return l.IPv4.parseCIDR(t)}catch(r){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},l.process=function(t){const e=this.parse(t);return"ipv6"===e.kind()&&e.isIPv4MappedAddress()?e.toIPv4Address():e},l.subnetMatch=function(t,e,r){let s,i,n,o;for(i in null==r&&(r="unicast"),e)if(Object.prototype.hasOwnProperty.call(e,i))for(n=e[i],!n[0]||n[0]instanceof Array||(n=[n]),s=0;s<n.length;s++)if(o=n[s],t.kind()===o[0].kind()&&t.match.apply(t,o))return i;return r},t.exports?t.exports=l:e.ipaddr=l}(e)}));class Se{static decodeIP(t){if(64===t.length&&0===parseInt(t,16))return"::/0";if(16!==t.length)return t;const e=parseInt(t.slice(8),16).toString(2).split("").reduce((t,e)=>t+ +e,0);let r=t.slice(0,8).replace(/(.{2})/g,t=>parseInt(t,16)+".");return r=r.slice(0,-1),`${r}/${e}`}static toString(t){if(4===t.byteLength||16===t.byteLength){const e=new Uint8Array(t);return be.fromByteArray(Array.from(e)).toString()}return this.decodeIP(ie.Convert.ToHex(t))}static fromString(t){const e=be.parse(t);return new Uint8Array(e.toByteArray()).buffer}}let Be=class{constructor(t={}){Object.assign(this,t)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};me([fe({type:Tt.TeletexString})],Be.prototype,"teletexString",void 0),me([fe({type:Tt.PrintableString})],Be.prototype,"printableString",void 0),me([fe({type:Tt.UniversalString})],Be.prototype,"universalString",void 0),me([fe({type:Tt.Utf8String})],Be.prototype,"utf8String",void 0),me([fe({type:Tt.BmpString})],Be.prototype,"bmpString",void 0),Be=me([he({type:Rt.Choice})],Be);let Ne=class extends Be{constructor(t={}){super(t),Object.assign(this,t)}toString(){return this.ia5String||(this.anyValue?ie.Convert.ToHex(this.anyValue):super.toString())}};me([fe({type:Tt.IA5String})],Ne.prototype,"ia5String",void 0),me([fe({type:Tt.Any})],Ne.prototype,"anyValue",void 0),Ne=me([he({type:Rt.Choice})],Ne);class ke{constructor(t={}){this.type="",this.value=new Ne,Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier})],ke.prototype,"type",void 0),me([fe({type:Ne})],ke.prototype,"value",void 0);let xe=ve=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,ve.prototype)}};xe=ve=me([he({type:Rt.Set,itemType:ke})],xe);let Ee=ge=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,ge.prototype)}};Ee=ge=me([he({type:Rt.Sequence,itemType:xe})],Ee);let Ue=Ae=class extends Ee{constructor(t){super(t),Object.setPrototypeOf(this,Ae.prototype)}};Ue=Ae=me([he({type:Rt.Sequence})],Ue);const Oe={fromASN:t=>Se.toString(Mt.fromASN(t)),toASN:t=>Mt.toASN(Se.fromString(t))};class Ie{constructor(t={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier})],Ie.prototype,"typeId",void 0),me([fe({type:Tt.Any,context:0})],Ie.prototype,"value",void 0);class Re{constructor(t={}){this.partyName=new ArrayBuffer(0),Object.assign(this,t)}}me([fe({type:Be,optional:!0,context:0,implicit:!0})],Re.prototype,"nameAssigner",void 0),me([fe({type:Be,context:1,implicit:!0})],Re.prototype,"partyName",void 0);let Te=class{constructor(t={}){Object.assign(this,t)}};me([fe({type:Ie,context:0,implicit:!0})],Te.prototype,"otherName",void 0),me([fe({type:Tt.IA5String,context:1,implicit:!0})],Te.prototype,"rfc822Name",void 0),me([fe({type:Tt.IA5String,context:2,implicit:!0})],Te.prototype,"dNSName",void 0),me([fe({type:Tt.Any,context:3,implicit:!0})],Te.prototype,"x400Address",void 0),me([fe({type:Ue,context:4,implicit:!1})],Te.prototype,"directoryName",void 0),me([fe({type:Re,context:5})],Te.prototype,"ediPartyName",void 0),me([fe({type:Tt.IA5String,context:6,implicit:!0})],Te.prototype,"uniformResourceIdentifier",void 0),me([fe({type:Tt.OctetString,context:7,implicit:!0,converter:Oe})],Te.prototype,"iPAddress",void 0),me([fe({type:Tt.ObjectIdentifier,context:8,implicit:!0})],Te.prototype,"registeredID",void 0),Te=me([he({type:Rt.Choice})],Te);const $e="1.3.6.1.5.5.7.1",je="2.5.29";var Ce;const De=$e+".1";class Ve{constructor(t={}){this.accessMethod="",this.accessLocation=new Te,Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier})],Ve.prototype,"accessMethod",void 0),me([fe({type:Te})],Ve.prototype,"accessLocation",void 0);let Pe=Ce=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,Ce.prototype)}};Pe=Ce=me([he({type:Rt.Sequence,itemType:Ve})],Pe);const We="2.5.29.35";class Me extends oe{}class He{constructor(t={}){t&&Object.assign(this,t)}}me([fe({type:Me,context:0,optional:!0,implicit:!0})],He.prototype,"keyIdentifier",void 0),me([fe({type:Te,context:1,optional:!0,implicit:!0,repeated:"sequence"})],He.prototype,"authorityCertIssuer",void 0),me([fe({type:Tt.Integer,context:2,optional:!0,implicit:!0,converter:Dt})],He.prototype,"authorityCertSerialNumber",void 0);const Je="2.5.29.19";class ze{constructor(t={}){this.cA=!1,Object.assign(this,t)}}var Ge;me([fe({type:Tt.Boolean,defaultValue:!1})],ze.prototype,"cA",void 0),me([fe({type:Tt.Integer,optional:!0})],ze.prototype,"pathLenConstraint",void 0);let Le=Ge=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,Ge.prototype)}};var qe;Le=Ge=me([he({type:Rt.Sequence,itemType:Te})],Le);const Fe="2.5.29.29";let Ze=qe=class extends Le{constructor(t){super(t),Object.setPrototypeOf(this,qe.prototype)}};var _e;Ze=qe=me([he({type:Rt.Sequence})],Ze);const Ke="2.5.29.32";let Qe=class{constructor(t={}){Object.assign(this,t)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String}};me([fe({type:Tt.IA5String})],Qe.prototype,"ia5String",void 0),me([fe({type:Tt.VisibleString})],Qe.prototype,"visibleString",void 0),me([fe({type:Tt.BmpString})],Qe.prototype,"bmpString",void 0),me([fe({type:Tt.Utf8String})],Qe.prototype,"utf8String",void 0),Qe=me([he({type:Rt.Choice})],Qe);class Xe{constructor(t={}){this.organization=new Qe,this.noticeNumbers=[],Object.assign(this,t)}}me([fe({type:Qe})],Xe.prototype,"organization",void 0),me([fe({type:Tt.Integer,repeated:"sequence"})],Xe.prototype,"noticeNumbers",void 0);class Ye{constructor(t={}){Object.assign(this,t)}}me([fe({type:Xe,optional:!0})],Ye.prototype,"noticeRef",void 0),me([fe({type:Qe,optional:!0})],Ye.prototype,"explicitText",void 0);let tr=class{constructor(t={}){Object.assign(this,t)}};me([fe({type:Tt.IA5String})],tr.prototype,"cPSuri",void 0),me([fe({type:Ye})],tr.prototype,"userNotice",void 0),tr=me([he({type:Rt.Choice})],tr);class er{constructor(t={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier})],er.prototype,"policyQualifierId",void 0),me([fe({type:Tt.Any})],er.prototype,"qualifier",void 0);class rr{constructor(t={}){this.policyIdentifier="",Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier})],rr.prototype,"policyIdentifier",void 0),me([fe({type:er,repeated:"sequence",optional:!0})],rr.prototype,"policyQualifiers",void 0);let sr=_e=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,_e.prototype)}};var ir;sr=_e=me([he({type:Rt.Sequence,itemType:rr})],sr);const nr="2.5.29.31";var or;!function(t){t[t.unused=1]="unused",t[t.keyCompromise=2]="keyCompromise",t[t.cACompromise=4]="cACompromise",t[t.affiliationChanged=8]="affiliationChanged",t[t.superseded=16]="superseded",t[t.cessationOfOperation=32]="cessationOfOperation",t[t.certificateHold=64]="certificateHold",t[t.privilegeWithdrawn=128]="privilegeWithdrawn",t[t.aACompromise=256]="aACompromise"}(or||(or={}));let ar=class{constructor(t={}){Object.assign(this,t)}};me([fe({type:Te,context:0,repeated:"sequence",implicit:!0})],ar.prototype,"fullName",void 0),me([fe({type:xe,context:1,implicit:!0})],ar.prototype,"nameRelativeToCRLIssuer",void 0),ar=me([he({type:Rt.Choice})],ar);class cr{constructor(t={}){Object.assign(this,t)}}me([fe({type:ar,context:0,optional:!0})],cr.prototype,"distributionPoint",void 0),me([fe({type:class extends ne{toJSON(){const t=[],e=this.toNumber();return e&or.aACompromise&&t.push("aACompromise"),e&or.affiliationChanged&&t.push("affiliationChanged"),e&or.cACompromise&&t.push("cACompromise"),e&or.certificateHold&&t.push("certificateHold"),e&or.cessationOfOperation&&t.push("cessationOfOperation"),e&or.keyCompromise&&t.push("keyCompromise"),e&or.privilegeWithdrawn&&t.push("privilegeWithdrawn"),e&or.superseded&&t.push("superseded"),e&or.unused&&t.push("unused"),t}toString(){return`[${this.toJSON().join(", ")}]`}},context:1,optional:!0,implicit:!0})],cr.prototype,"reasons",void 0),me([fe({type:Te,context:2,optional:!0,repeated:"sequence",implicit:!0})],cr.prototype,"cRLIssuer",void 0);let ur=ir=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,ir.prototype)}};ur=ir=me([he({type:Rt.Sequence,itemType:cr})],ur);const hr="2.5.29.21";var fr;!function(t){t[t.unspecified=0]="unspecified",t[t.keyCompromise=1]="keyCompromise",t[t.cACompromise=2]="cACompromise",t[t.affiliationChanged=3]="affiliationChanged",t[t.superseded=4]="superseded",t[t.cessationOfOperation=5]="cessationOfOperation",t[t.certificateHold=6]="certificateHold",t[t.removeFromCRL=8]="removeFromCRL",t[t.privilegeWithdrawn=9]="privilegeWithdrawn",t[t.aACompromise=10]="aACompromise"}(fr||(fr={}));let lr=class{constructor(t=fr.unspecified){this.reason=fr.unspecified,this.reason=t}toJSON(){return fr[this.reason]}toString(){return this.toJSON()}};var dr;me([fe({type:Tt.Enumerated})],lr.prototype,"reason",void 0),lr=me([he({type:Rt.Choice})],lr);const pr="2.5.29.37";let yr=dr=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,dr.prototype)}};yr=dr=me([he({type:Rt.Sequence,itemType:Tt.ObjectIdentifier})],yr);const wr="2.5.29.54";let mr=class{constructor(t=new ArrayBuffer(0)){this.value=t}};me([fe({type:Tt.Integer,converter:Dt})],mr.prototype,"value",void 0),mr=me([he({type:Rt.Choice})],mr);const vr="2.5.29.24";let gr=class{constructor(t){this.value=new Date,t&&(this.value=t)}};var Ar;me([fe({type:Tt.GeneralizedTime})],gr.prototype,"value",void 0),gr=me([he({type:Rt.Choice})],gr);const br="2.5.29.18";let Sr=Ar=class extends Le{constructor(t){super(t),Object.setPrototypeOf(this,Ar.prototype)}};Sr=Ar=me([he({type:Rt.Sequence})],Sr);const Br="2.5.29.15";var Nr,kr;!function(t){t[t.digitalSignature=1]="digitalSignature",t[t.nonRepudiation=2]="nonRepudiation",t[t.keyEncipherment=4]="keyEncipherment",t[t.dataEncipherment=8]="dataEncipherment",t[t.keyAgreement=16]="keyAgreement",t[t.keyCertSign=32]="keyCertSign",t[t.cRLSign=64]="cRLSign",t[t.encipherOnly=128]="encipherOnly",t[t.decipherOnly=256]="decipherOnly"}(Nr||(Nr={}));class xr extends ne{toJSON(){const t=this.toNumber(),e=[];return t&Nr.cRLSign&&e.push("crlSign"),t&Nr.dataEncipherment&&e.push("dataEncipherment"),t&Nr.decipherOnly&&e.push("decipherOnly"),t&Nr.digitalSignature&&e.push("digitalSignature"),t&Nr.encipherOnly&&e.push("encipherOnly"),t&Nr.keyAgreement&&e.push("keyAgreement"),t&Nr.keyCertSign&&e.push("keyCertSign"),t&Nr.keyEncipherment&&e.push("keyEncipherment"),t&Nr.nonRepudiation&&e.push("nonRepudiation"),e}toString(){return`[${this.toJSON().join(", ")}]`}}const Er="2.5.29.30";class Ur{constructor(t={}){this.base=new Te,this.minimum=0,Object.assign(this,t)}}me([fe({type:Te})],Ur.prototype,"base",void 0),me([fe({type:Tt.Integer,context:0,defaultValue:0,implicit:!0})],Ur.prototype,"minimum",void 0),me([fe({type:Tt.Integer,context:1,optional:!0,implicit:!0})],Ur.prototype,"maximum",void 0);let Or=kr=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,kr.prototype)}};Or=kr=me([he({type:Rt.Sequence,itemType:Ur})],Or);class Ir{constructor(t={}){Object.assign(this,t)}}me([fe({type:Or,context:0,optional:!0,implicit:!0})],Ir.prototype,"permittedSubtrees",void 0),me([fe({type:Or,context:1,optional:!0,implicit:!0})],Ir.prototype,"excludedSubtrees",void 0);const Rr="2.5.29.36";class Tr{constructor(t={}){Object.assign(this,t)}}me([fe({type:Tt.Integer,context:0,implicit:!0,optional:!0,converter:Dt})],Tr.prototype,"requireExplicitPolicy",void 0),me([fe({type:Tt.Integer,context:1,implicit:!0,optional:!0,converter:Dt})],Tr.prototype,"inhibitPolicyMapping",void 0);const $r="2.5.29.33";class jr{constructor(t={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,t)}}var Cr;me([fe({type:Tt.ObjectIdentifier})],jr.prototype,"issuerDomainPolicy",void 0),me([fe({type:Tt.ObjectIdentifier})],jr.prototype,"subjectDomainPolicy",void 0);const Dr="2.5.29.17";let Vr=Cr=class extends Le{constructor(t){super(t),Object.setPrototypeOf(this,Cr.prototype)}};Vr=Cr=me([he({type:Rt.Sequence})],Vr);class Pr{constructor(t={}){this.type="",this.values=[],Object.assign(this,t)}}var Wr;me([fe({type:Tt.ObjectIdentifier})],Pr.prototype,"type",void 0),me([fe({type:Tt.Any,repeated:"set"})],Pr.prototype,"values",void 0);const Mr="2.5.29.9";let Hr=Wr=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,Wr.prototype)}};Hr=Wr=me([he({type:Rt.Sequence,itemType:Pr})],Hr);const Jr="2.5.29.16";class zr{constructor(t={}){Object.assign(this,t)}}me([fe({type:Tt.GeneralizedTime,context:0,implicit:!0,optional:!0})],zr.prototype,"notBefore",void 0),me([fe({type:Tt.GeneralizedTime,context:1,implicit:!0,optional:!0})],zr.prototype,"notAfter",void 0);const Gr="1.2.840.113533.7.65.0";var Lr;!function(t){t[t.keyUpdateAllowed=1]="keyUpdateAllowed",t[t.newExtensions=2]="newExtensions",t[t.pKIXCertificate=4]="pKIXCertificate"}(Lr||(Lr={}));class qr extends ne{toJSON(){const t=[],e=this.toNumber();return e&Lr.pKIXCertificate&&t.push("pKIXCertificate"),e&Lr.newExtensions&&t.push("newExtensions"),e&Lr.keyUpdateAllowed&&t.push("keyUpdateAllowed"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class Fr{constructor(t={}){this.entrustVers="",this.entrustInfoFlags=new qr,Object.assign(this,t)}}me([fe({type:Tt.GeneralString})],Fr.prototype,"entrustVers",void 0),me([fe({type:qr})],Fr.prototype,"entrustInfoFlags",void 0);class Zr{constructor(t={}){this.algorithm="",Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier})],Zr.prototype,"algorithm",void 0),me([fe({type:Tt.Any,optional:!0})],Zr.prototype,"parameters",void 0);class _r{constructor(t={}){this.algorithm=new Zr,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,t)}}me([fe({type:Zr})],_r.prototype,"algorithm",void 0),me([fe({type:Tt.BitString})],_r.prototype,"subjectPublicKey",void 0);let Kr=class{constructor(t){t&&("string"==typeof t||"number"==typeof t?this.utcTime=new Date(t):t instanceof Date?this.utcTime=t:Object.assign(this,t))}getTime(){const t=this.utcTime||this.generalTime;if(!t)throw new Error("Cannot get time from CHOICE object");return t}};me([fe({type:Tt.UTCTime})],Kr.prototype,"utcTime",void 0),me([fe({type:Tt.GeneralizedTime})],Kr.prototype,"generalTime",void 0),Kr=me([he({type:Rt.Choice})],Kr);class Qr{constructor(t){this.notBefore=new Kr(new Date),this.notAfter=new Kr(new Date),t&&(this.notBefore=new Kr(t.notBefore),this.notAfter=new Kr(t.notAfter))}}var Xr;me([fe({type:Kr})],Qr.prototype,"notBefore",void 0),me([fe({type:Kr})],Qr.prototype,"notAfter",void 0);class Yr{constructor(t={}){this.extnID="",this.critical=Yr.CRITICAL,this.extnValue=new oe,Object.assign(this,t)}}Yr.CRITICAL=!1,me([fe({type:Tt.ObjectIdentifier})],Yr.prototype,"extnID",void 0),me([fe({type:Tt.Boolean,defaultValue:Yr.CRITICAL})],Yr.prototype,"critical",void 0),me([fe({type:oe})],Yr.prototype,"extnValue",void 0);let ts=Xr=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,Xr.prototype)}};var es,rs;ts=Xr=me([he({type:Rt.Sequence,itemType:Yr})],ts),function(t){t[t.v1=0]="v1",t[t.v2=1]="v2",t[t.v3=2]="v3"}(es||(es={}));class ss{constructor(t={}){this.version=es.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new Zr,this.issuer=new Ue,this.validity=new Qr,this.subject=new Ue,this.subjectPublicKeyInfo=new _r,Object.assign(this,t)}}me([fe({type:Tt.Integer,context:0,defaultValue:es.v1})],ss.prototype,"version",void 0),me([fe({type:Tt.Integer,converter:Dt})],ss.prototype,"serialNumber",void 0),me([fe({type:Zr})],ss.prototype,"signature",void 0),me([fe({type:Ue})],ss.prototype,"issuer",void 0),me([fe({type:Qr})],ss.prototype,"validity",void 0),me([fe({type:Ue})],ss.prototype,"subject",void 0),me([fe({type:_r})],ss.prototype,"subjectPublicKeyInfo",void 0),me([fe({type:Tt.BitString,context:1,implicit:!0,optional:!0})],ss.prototype,"issuerUniqueID",void 0),me([fe({type:Tt.BitString,context:2,implicit:!0,optional:!0})],ss.prototype,"subjectUniqueID",void 0),me([fe({type:ts,context:3,optional:!0})],ss.prototype,"extensions",void 0);class is{constructor(t={}){this.tbsCertificate=new ss,this.signatureAlgorithm=new Zr,this.signatureValue=new ArrayBuffer(0),Object.assign(this,t)}}me([fe({type:ss})],is.prototype,"tbsCertificate",void 0),me([fe({type:Zr})],is.prototype,"signatureAlgorithm",void 0),me([fe({type:Tt.BitString})],is.prototype,"signatureValue",void 0);class ns{constructor(t={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new Kr,Object.assign(this,t)}}me([fe({type:Tt.Integer,converter:Dt})],ns.prototype,"userCertificate",void 0),me([fe({type:Kr})],ns.prototype,"revocationDate",void 0),me([fe({type:Yr,optional:!0,repeated:"sequence"})],ns.prototype,"crlEntryExtensions",void 0);class os{constructor(t={}){this.signature=new Zr,this.issuer=new Ue,this.thisUpdate=new Kr,Object.assign(this,t)}}me([fe({type:Tt.Integer,optional:!0})],os.prototype,"version",void 0),me([fe({type:Zr})],os.prototype,"signature",void 0),me([fe({type:Ue})],os.prototype,"issuer",void 0),me([fe({type:Kr})],os.prototype,"thisUpdate",void 0),me([fe({type:Kr,optional:!0})],os.prototype,"nextUpdate",void 0),me([fe({type:ns,repeated:"sequence",optional:!0})],os.prototype,"revokedCertificates",void 0),me([fe({type:Yr,optional:!0,context:0,repeated:"sequence"})],os.prototype,"crlExtensions",void 0);class as{constructor(t={}){this.tbsCertList=new os,this.signatureAlgorithm=new Zr,this.signature=new ArrayBuffer(0),Object.assign(this,t)}}me([fe({type:os})],as.prototype,"tbsCertList",void 0),me([fe({type:Zr})],as.prototype,"signatureAlgorithm",void 0),me([fe({type:Tt.BitString})],as.prototype,"signature",void 0);const cs=$e+".2";var us;!function(t){t[t.picture=0]="picture",t[t.handwrittenSignature=1]="handwrittenSignature"}(us||(us={}));let hs=class{constructor(t={}){Object.assign(this,t)}};me([fe({type:Tt.Integer})],hs.prototype,"predefinedBiometricType",void 0),me([fe({type:Tt.ObjectIdentifier})],hs.prototype,"biometricDataOid",void 0),hs=me([he({type:Rt.Choice})],hs);class fs{constructor(t={}){this.typeOfBiometricData=new hs,this.hashAlgorithm=new Zr,this.biometricDataHash=new oe,Object.assign(this,t)}}me([fe({type:hs})],fs.prototype,"typeOfBiometricData",void 0),me([fe({type:Zr})],fs.prototype,"hashAlgorithm",void 0),me([fe({type:oe})],fs.prototype,"biometricDataHash",void 0),me([fe({type:Tt.IA5String,optional:!0})],fs.prototype,"sourceDataUri",void 0);let ls=rs=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,rs.prototype)}};var ds,ps;ls=rs=me([he({type:Rt.Sequence,itemType:fs})],ls);const ys=$e+".3";class ws{constructor(){this.statementId="",this.statementInfo=new ArrayBuffer(0)}}me([fe({type:Tt.ObjectIdentifier})],ws.prototype,"statementId",void 0),me([fe({type:Tt.Any,optional:!0})],ws.prototype,"statementInfo",void 0);let ms=ds=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,ds.prototype)}};ms=ds=me([he({type:Rt.Sequence,itemType:Te})],ms);class vs{constructor(t={}){Object.assign(this,t)}}me([fe({type:Tt.ObjectIdentifier,optional:!0})],vs.prototype,"semanticsIdentifier",void 0),me([fe({type:ms,optional:!0})],vs.prototype,"nameRegistrationAuthorities",void 0);let gs=ps=class extends ye{constructor(t){super(t),Object.setPrototypeOf(this,ps.prototype)}};gs=ps=me([he({type:Rt.Sequence,itemType:ws})],gs);let As=class extends Be{};var bs;As=me([he({type:Rt.Choice})],As),function(t){t.M="M",t.F="F",t.m="m",t.f="f"}(bs||(bs={}));export{hr as $,he as A,ne as B,sr as C,Be as D,ts as E,Rr as F,Te as G,Tr as H,Er as I,Ir as J,Me as K,Br as L,xr as M,Ue as N,oe as O,ct as P,gs as Q,br as R,Hr as S,Sr as T,vr as U,gr as V,wr as W,mr as X,pr as Y,yr as Z,me as _,fe as a,lr as a0,ur as a1,nr as a2,Ke as a3,Fe as a4,Ze as a5,Je as a6,ze as a7,We as a8,He as a9,H as aA,T as aB,Bt as aC,I as aD,Q as aE,rt as aF,it as aG,at as aH,ut as aI,ht as aJ,ft as aK,lt as aL,dt as aM,pt as aN,yt as aO,wt as aP,mt as aQ,D as aR,o as aS,a as aT,i as aU,Qe as aV,Re as aW,Ye as aX,De as aa,Pe as ab,Pr as ac,Le as ad,Kr as ae,_r as af,s as ag,Nt as ah,V as ai,_ as aj,b as ak,Ot as al,f as am,xt as an,c as ao,y as ap,m as aq,v as ar,w as as,L as at,A as au,z as av,Ut as aw,W as ax,P as ay,kt as az,Tt as b,Rt as c,Dt as d,Zr as e,we as f,Mt as g,ye as h,je as i,de as j,ie as k,Ie as l,is as m,Yr as n,cs as o,ls as p,Gr as q,Fr as r,Jr as s,zr as t,ys as u,Mr as v,Dr as w,Vr as x,$r as y,jr as z}