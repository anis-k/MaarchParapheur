import{r as e,h as t,H as r}from"./p-ccfcf823.js";import"./p-7005d10f.js";import{i as o}from"./p-9098eee6.js";import{g as i}from"./p-be826c49.js";const l=class{constructor(t){e(this,t),this.providers=[],this.onSubmit=e=>{e.preventDefault(),this.ponSubmit({provider:this.providerForm.fields,subject:this.subjectForm.fields,publicKey:this.publicKeyForm.fields,options:this.optionsForm.fields})},this.onChange=e=>{"provider"===e.name&&(this.providerForm=e),"subject"===e.name&&(this.subjectForm=e),"publicKey"===e.name&&(this.publicKeyForm=e),"options"===e.name&&(this.optionsForm=e)}}isFormValid(){if(!(this.providerForm&&this.subjectForm&&this.publicKeyForm&&this.optionsForm))return!1;let e=!0;return this.providerForm&&!this.providerForm.valid&&(e=!1),this.subjectForm&&!this.subjectForm.valid&&(e=!1),this.publicKeyForm&&!this.publicKeyForm.valid&&(e=!1),this.optionsForm&&!this.optionsForm.valid&&(e=!1),e}render(){const e=this.isFormValid();return t(r,null,t("peculiar-fortify-box",{stroke:"grey_3",class:"title"},t("peculiar-fortify-typography",{type:"h4"},i("enrollment.title"))),t("form",{onSubmit:this.onSubmit},t("peculiar-fortify-box",{stroke:"grey_2",class:"group"},t("peculiar-fortify-typography",{type:"h7",uppercase:!0},i("enrollment.provider.title")),t("peculiar-fortify-enrollment-form-provider",{class:"container",providers:this.providers,ponChange:this.onChange})),t("peculiar-fortify-box",{stroke:"grey_2",class:"group"},t("peculiar-fortify-typography",{type:"h7",uppercase:!0},i("enrollment.subject.title")),t("peculiar-fortify-enrollment-form-subject",{class:"container",ponChange:this.onChange})),t("peculiar-fortify-box",{stroke:"grey_2",class:"group"},t("peculiar-fortify-typography",{type:"h7",uppercase:!0},i("enrollment.publicKey.title")),t("peculiar-fortify-enrollment-form-public-key",{class:"container",ponChange:this.onChange})),t("peculiar-fortify-box",{stroke:"grey_2",class:"group"},t("peculiar-fortify-typography",{type:"h7",uppercase:!0},i("enrollment.options.title")),t("peculiar-fortify-enrollment-form-options",{class:"container",ponChange:this.onChange})),t("div",{class:"controls"},t("peculiar-fortify-button-group",null,t("peculiar-fortify-button",{onClick:this.ponCancel},i("actions.cancel")),t("peculiar-fortify-button",{bgType:"fill",color:"secondary",colorText:"light",type:"submit",disabled:!e},i("actions.create"))))))}};l.style=".sc-peculiar-fortify-enrollment-form-h{-webkit-box-sizing:border-box;box-sizing:border-box}.sc-peculiar-fortify-enrollment-form-h *.sc-peculiar-fortify-enrollment-form,.sc-peculiar-fortify-enrollment-form-h *.sc-peculiar-fortify-enrollment-form:before,.sc-peculiar-fortify-enrollment-form-h *.sc-peculiar-fortify-enrollment-form:after{-webkit-box-sizing:inherit;box-sizing:inherit}.sc-peculiar-fortify-enrollment-form-h{display:block;height:100%;overflow:auto}.group.sc-peculiar-fortify-enrollment-form{padding:32px 20px 22px 20px;border-width:0px 0px 1px 0px}.container.sc-peculiar-fortify-enrollment-form{margin:10px -10px 0}.controls.sc-peculiar-fortify-enrollment-form{text-align:right;margin-top:30px}";const n=class{constructor(t){e(this,t)}render(){return t(r,null,t("peculiar-fortify-layout",{type:"message",titleValue:i("enrollment.error.title"),descriptionValue:i("If you want to try again click the button below")},t("peculiar-fortify-button",{onClick:this.ponCancel},i("actions.cancel")),t("peculiar-fortify-button",{bgType:"fill",color:"secondary",colorText:"light",onClick:this.ponAccept},i("actions.tryAgain"))))}};n.style=".sc-peculiar-fortify-enrollment-rejected-h{-webkit-box-sizing:border-box;box-sizing:border-box}.sc-peculiar-fortify-enrollment-rejected-h *.sc-peculiar-fortify-enrollment-rejected,.sc-peculiar-fortify-enrollment-rejected-h *.sc-peculiar-fortify-enrollment-rejected:before,.sc-peculiar-fortify-enrollment-rejected-h *.sc-peculiar-fortify-enrollment-rejected:after{-webkit-box-sizing:inherit;box-sizing:inherit}.sc-peculiar-fortify-enrollment-rejected-h{width:100%;display:block;height:100%}";
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the BSD 3-Clause license found in the
 * LICENSE file in the root directory of this source tree.
 */
class s{static formatHex(e){return e.replace(/(.{32})/g,"$1\n").replace(/(.{4})/g,"$1 ").trim()}static formatBase64(e){return e.replace(/(.{64})/g,"$1\n")}}
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the BSD 3-Clause license found in the
 * LICENSE file in the root directory of this source tree.
 */
function c(e,t="application/octet-stream",r,o){const i=new Blob([e],{type:t});if(navigator.msSaveBlob)return navigator.msSaveBlob(i,`${r}.${o}`),new Promise(e=>setTimeout(e,100));const l=window.URL.createObjectURL(i),n=document.createElement("a"),s=document.createElement("iframe");return n.style.display="none",s.style.display="none",s.name=l,document.body.appendChild(s),n.href=l,n.target=l,n.download=`${r}.${o}`,document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click")),document.body.removeChild(n),new Promise(e=>setTimeout(()=>{document.body.removeChild(s),e()},100))}
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the BSD 3-Clause license found in the
 * LICENSE file in the root directory of this source tree.
 */s.x509={pem:e=>`-----BEGIN CERTIFICATE-----\n${s.formatBase64(o.Convert.ToBase64(e))}\n-----END CERTIFICATE-----`,der:e=>s.formatHex(o.Convert.ToHex(e))},s.csr={pem:e=>`-----BEGIN CERTIFICATE REQUEST-----\n${s.formatBase64(o.Convert.ToBase64(e))}\n-----END CERTIFICATE REQUEST-----`,der:e=>s.formatHex(o.Convert.ToHex(e))};class a{}a.x509={asPEM:(e,t)=>{c(o.Convert.FromString(s.x509.pem(e)),"application/pkix-cert",t,"cer")},asDER:(e,t)=>{c(o.Convert.FromString(s.x509.der(e)),"application/pkix-cert",t,"cer")}},a.csr={asPEM:(e,t)=>{c(o.Convert.FromString(s.csr.pem(e)),"application/pkcs10",t,"csr")},asDER:(e,t)=>{c(o.Convert.FromString(s.csr.der(e)),"application/pkcs10",t,"csr")}};const p=class{constructor(t){e(this,t),this.type="csr",this.handleDownload=()=>{"csr"===this.type?a.csr.asPEM(this.der,this.name):a.x509.asPEM(this.der,this.name)}}render(){let e,o;return"csr"===this.type?(e=i("enrollment.success.csr.title"),o=s.csr.pem(this.der)):(e=i("enrollment.success.certificate.title"),o=s.x509.pem(this.der)),t(r,null,t("peculiar-fortify-layout",{type:"dialog",titleValue:e,slotDialogContent:t("textarea",{class:{textarea:!0}},o)},t("div",null),t("div",null,t("peculiar-fortify-button",{onClick:this.ponClose},i("actions.close")),t("peculiar-fortify-button",{bgType:"fill",color:"secondary",colorText:"light",onClick:this.handleDownload},"Download PEM"))))}};p.style=":host{-webkit-box-sizing:border-box;box-sizing:border-box}:host *,:host *:before,:host *:after{-webkit-box-sizing:inherit;box-sizing:inherit}peculiar-fortify-enrollment-resolved{display:block;height:100%;width:100%}peculiar-fortify-enrollment-resolved .textarea{border-radius:3px;height:100%;width:100%;overflow:auto;resize:none;margin:0;padding:16px 20px;display:block;font-family:monospace;font-size:11px;font-size:var(--pv-font-size-c1);border-color:#e1e4e6;border-color:rgba(var(--pv-color-grey_3-rgb), 1);color:#6d7d87;color:rgba(var(--pv-color-grey_5-rgb), 1)}";export{l as peculiar_fortify_enrollment_form,n as peculiar_fortify_enrollment_rejected,p as peculiar_fortify_enrollment_resolved}