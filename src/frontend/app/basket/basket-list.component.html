<div class="admin-container" [class.admin-is-mobile]="mobileQuery.matches">
    <mat-sidenav-container autosize class="admin-sidenav-container">
        <mat-sidenav #snav [mode]="mobileMode ? 'over' : 'side'" [fixedInViewport]="mobileMode" fixedTopGap="56" [opened]="mobileMode ? false : true"
            autoFocus="false" style="overflow-x:hidden;" [ngStyle]="{'width': mobileMode ? '80%' : '400px'}">
            <menu-shortcut></menu-shortcut>
            <menu-nav></menu-nav>
            <basket-home *ngIf="homeData" [homeData]="homeData" [snavL]="snav"></basket-home>
            <mat-divider></mat-divider>
        </mat-sidenav>
        <mat-sidenav-content>
            <div *ngIf="loading" style="display:flex;height:100%;">
                <mat-spinner style="margin:auto;"></mat-spinner>
            </div>
            <mat-card class="card-app-content">
                <div class="example-loading-shade" *ngIf="isLoadingResults">
                    <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
                </div>
                <div class="row" style="margin:0px;">
                    <div class="col-md-6 col-xs-6">
                        <mat-button-toggle-group #group="matButtonToggleGroup" multiple>
                            <mat-button-toggle value="left">
                              <mat-icon class="fa fa-stopwatch" style="height:auto;"></mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="center">
                                <mat-icon class="fa fa-circle" style="height:auto;color:blue;"></mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="center">
                                <mat-icon class="fa fa-circle" style="height:auto;color:orange;"></mat-icon>
                            </mat-button-toggle>
                            <mat-button-toggle value="center">
                                <mat-icon class="fa fa-circle" style="height:auto;color:red;"></mat-icon>
                            </mat-button-toggle>
                          </mat-button-toggle-group>
                    </div>
                    <div class="col-md-6 col-xs-6">
                        <mat-paginator [length]="resultsLength" [pageSize]="10"></mat-paginator>
                    </div>
                </div>
                <table #tableBasketListSort="matSort" mat-table [dataSource]="data" matSort matSortActive="res_id" matSortDisableClear matSortDirection="asc"
                    style="width:100%;table-layout: fixed;">
                    <!-- Number Column -->
                    <ng-container matColumnDef="res_id">
                        <td mat-cell *matCellDef="let row" [ngStyle]="{'width': mobileMode ? '30%' : '10%'}" style="text-align:center;overflow:hidden;text-overflow: ellipsis;white-space: nowrap;padding: 5px;vertical-align: middle;">
                            <div *ngIf="row.closing_date == null && mobileMode" id="{{row.res_id}}_creation_date" style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;"
                                title='{{row.creation_date | date : "le dd/MM/y à HH:mm"}}'>
                                <i class="fa fa-calendar" title="{{lang.creationDate}}"></i> {{row.creation_date | timeAgo}}
                            </div>
                            <div *ngIf="!mobileMode" style="padding-top: 5px;color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;" title="{{lang[row.category_id]}}">
                                {{lang[row.category_id]}}
                            </div>
                            <div style="overflow: hidden;text-overflow: ellipsis;">
                                <mat-icon [ngStyle]="{'color': row.priority_color}" color="primary" class="{{row.status_icon.charAt(0)}}{{row.status_icon.charAt(1)}} {{row.status_icon}} {{row.status_icon.charAt(0)}}{{row.status_icon.charAt(1)}}-2x" title="{{row.status_label}} ({{row.status_id}})"></mat-icon>
                            </div>
                            <div style="padding-top: 5px;color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;" title="{{row.alt_identifier}} (n°{{row.res_id}})">
                                {{row.alt_identifier}}
                            </div>

                        </td>
                    </ng-container>
                    <ng-container matColumnDef="subject">
                        <td mat-cell *matCellDef="let row" style="width:50%;overflow:hidden;text-overflow: ellipsis;white-space: nowrap;padding: 5px;vertical-align: middle;">
                            <div *ngIf="row.closing_date == null && mobileMode" style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;text-align: right;">
                                <i class="fa fa-stopwatch" title="{{lang.processLimitDate}}"></i>&nbsp;
                                <span [innerHTML]="row.process_limit_date | timeLimit" title='{{row.process_limit_date | date : "le dd/MM/y à HH:mm"}}'></span>
                            </div>
                            <div style="overflow: hidden;text-overflow: ellipsis;" title="{{row.subject}}">
                                <span *ngIf="!mobileMode" class="label" [ngStyle]="{'background': row.priority_color}">{{row.priority_label}}</span>&nbsp;
                                <span>{{row.subject}}</span>
                            </div>
                            <div *ngIf="mobileMode" style="padding-top: 5px;color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;text-align: right;">
                                {{row.dest_user}}
                            </div>
                            <div style="display:hidden;">
                                &nbsp;
                            </div>
                            <div *ngIf="!mobileMode && (row.folder_name || row.case_label)">
                                <span *ngIf="row.folder_name" class="label label-default" style="background-color:rgba(0,0,0,0.2);margin-left: 5px;margin-right: 5px;" title="{{lang.folder}}"><i class="fa fa-folder"></i> {{row.folder_name}}</span>
                                <span *ngIf="row.case_label" class="label label-default" style="background-color:rgba(0,0,0,0.2);margin-left: 5px;margin-right: 5px;" title="{{lang.case}}"><i class="fa fa-suitcase"></i> {{row.case_label}}</span>
                            </div>
                            <!--<div>
                                <button mat-stroked-button color="primary" style="margin:5px;line-height: 20px;width: 150px;overflow: hidden;text-overflow: ellipsis;">réponse du zpfezk zekf opezf</button>
                                <button mat-stroked-button color="primary" style="margin:5px;line-height: 20px;width: 150px;overflow: hidden;text-overflow: ellipsis;">réponse du zpfezk zekf opezf</button>
                                <button mat-stroked-button color="primary" style="margin:5px;line-height: 20px;width: 150px;overflow: hidden;text-overflow: ellipsis;">réponse du zpfezk zekf opezf</button>
                            </div>
                            <div style="padding-top: 5px;color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;">
                                                                    <span><i class="fa fa-check" color="accent"></i> Barbara BAIN </span>&nbsp;<i class="fa fa-arrow-right"></i>&nbsp;<span><i class="fa fa-user"></i> Patricia PETIT</span>
                                                                </div>-->
                        </td>
                    </ng-container>
                    <ng-container matColumnDef="contact_society">
                        <td mat-cell *matCellDef="let row" style="width:25%;overflow:hidden;text-overflow: ellipsis;white-space: nowrap;padding: 5px;vertical-align: middle;">
                            <div style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;">
                                <b>De:</b>&nbsp;
                                <span *ngIf="row.user_firstname">{{row.user_firstname}}</span>&nbsp;
                                <span *ngIf="row.user_lastname">{{row.user_lastname}}</span>
                                <span *ngIf="row.contact_lastname==''">{{row.contact_society}}</span>
                                <span *ngIf="row.contact_society==''">{{row.contact_lastname}}</span> &nbsp;
                            </div>
                            <div style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;">
                                <b>Pour:</b>&nbsp;
                                <span title="{{row.user_dest_firstname}}&nbsp;{{row.user_dest_lastname}} ({{row.entity_destination}})">{{row.user_dest_firstname}}&nbsp;{{row.user_dest_lastname}} ({{row.entity_destination}})</span>
                            </div>
                            <div style="padding-top:10px;">
                                <i class="fa fa-file" color="primary"></i>&nbsp;{{row.doctype_label}}
                            </div>
                        </td>
                    </ng-container>

                    <ng-container matColumnDef="creation_date">
                        <td mat-cell *matCellDef="let row" style="text-align: right;width:15%;overflow:hidden;text-overflow: ellipsis;white-space: nowrap;padding: 5px;vertical-align: middle;">
                            <div *ngIf="row.closing_date == null" id="{{row.res_id}}_creation_date" style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;"
                                title='{{row.creation_date | date : "le dd/MM/y à HH:mm"}}'>
                                <i class="fa fa-calendar" title="{{lang.creationDate}}"></i> {{row.creation_date | timeAgo}}
                            </div>
                            <div *ngIf="row.closing_date == null" style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;">
                                <i class="fa fa-stopwatch" title="{{lang.processLimitDate}}"></i>&nbsp;
                                <span [innerHTML]="row.process_limit_date | timeLimit" title='{{row.process_limit_date | date : "le dd/MM/y à HH:mm"}}'></span>
                            </div>
                            <div *ngIf="row.closing_date != null" style="color: rgba(0,0,0,0.4);font-size: 90%;overflow: hidden;text-overflow: ellipsis;">
                                <i class="fa fa-lock" title="{{lang.closingDate}}"></i>&nbsp;
                                <span title='{{row.closing_date | date : "le dd/MM/y à HH:mm"}}'>{{row.closing_date | timeAgo}}</span>
                            </div>
                            <div style="white-space:normal;">
                                <button mat-icon-button (click)="openAttachSheet(row)">
                                    <mat-icon color="primary" class="fa fa-paperclip"></mat-icon>
                                </button>
                                <button mat-icon-button (click)="openBottomSheet(row)">
                                    <mat-icon color="primary" class="fa fa-sticky-note"></mat-icon>
                                </button>
                                <button mat-icon-button (click)="goTo(row);">
                                    <mat-icon color="primary" class="fa fa-eye"></mat-icon>
                                </button>
                                <button mat-icon-button (click)="openDiffusionSheet(row)">
                                    <mat-icon color="primary" class="fa fa-share-alt"></mat-icon>
                                </button>
                                <button mat-icon-button (click)="goToDetail(row);">
                                    <mat-icon color="primary" class="fa fa-info-circle"></mat-icon>
                                </button>
                            </div>
                        </td>
                    </ng-container>

                    <tr mat-row *matRowDef="let row; columns: displayedColumnsBasket;" (click)="test();"></tr>
                </table>
                <div class="mat-paginator" style="min-height:48px;min-height: 48px;display: flex;justify-content: end;align-items: center;padding-right: 20px;">{{resultsLength}} {{lang.entries}}</div>
            </mat-card>
        </mat-sidenav-content>
        <mat-sidenav #snav2 mode="over" [fixedInViewport]="mobileQuery.matches" fixedTopGap="56"
            position='end' [opened]="mobileQuery.matches ? false : false" style="overflow-x:hidden;" [ngStyle]="{'width': mobileMode ? '80%' : '40%'}">
            <div *ngIf="innerHtml" [innerHTML]="innerHtml" style="height: 100%;overflow: hidden;"></div>
        </mat-sidenav>
    </mat-sidenav-container>
</div>